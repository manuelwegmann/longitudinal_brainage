This job can be monitored from: https://job.c3se.chalmers.se/alvis/4600287
We are in main.
Warning: Folder for participant sub-OAS30937 does not exist and will be deleted.
Warning: Folder for participant sub-OAS31357 does not exist and will be deleted.
Train size (number of participants): 592, Validation size: 198, Test size: 198
We are in train.
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Loaded 963 images.
Loaded 963 rows of metadata.
Loaded 963 targets.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Loaded 344 images.
Loaded 344 rows of metadata.
Loaded 344 targets.
We are in epoch (training):  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Epoch 0: Avg Train Loss = 602.7019
Epoch 0: Avg Train MAE = 16.3665
We are in epoch (val):  0
Epoch 0: Avg Val Loss = 107.8384
Epoch 0: Avg Val MAE = 8.9000
Validation loss improved, saving best model.
We are in epoch (training):  1
Epoch 1: Avg Train Loss = 72.1206
Epoch 1: Avg Train MAE = 6.6474
We are in epoch (val):  1
Epoch 1: Avg Val Loss = 162.4499
Epoch 1: Avg Val MAE = 10.7509
No improvement in validation loss for 1 epochs.
We are in epoch (training):  2
Epoch 2: Avg Train Loss = 68.0648
Epoch 2: Avg Train MAE = 6.4605
We are in epoch (val):  2
Epoch 2: Avg Val Loss = 84.5538
Epoch 2: Avg Val MAE = 7.0056
Validation loss improved, saving best model.
We are in epoch (training):  3
Epoch 3: Avg Train Loss = 65.7492
Epoch 3: Avg Train MAE = 6.3893
We are in epoch (val):  3
Epoch 3: Avg Val Loss = 60.6626
Epoch 3: Avg Val MAE = 5.8828
Validation loss improved, saving best model.
We are in epoch (training):  4
Epoch 4: Avg Train Loss = 62.2045
Epoch 4: Avg Train MAE = 6.2044
We are in epoch (val):  4
Epoch 4: Avg Val Loss = 60.8225
Epoch 4: Avg Val MAE = 6.2737
No improvement in validation loss for 1 epochs.
We are in epoch (training):  5
Epoch 5: Avg Train Loss = 63.2571
Epoch 5: Avg Train MAE = 6.2048
We are in epoch (val):  5
Epoch 5: Avg Val Loss = 74.9200
Epoch 5: Avg Val MAE = 6.5623
No improvement in validation loss for 2 epochs.
We are in epoch (training):  6
Epoch 6: Avg Train Loss = 65.5994
Epoch 6: Avg Train MAE = 6.4949
We are in epoch (val):  6
Epoch 6: Avg Val Loss = 229.5289
Epoch 6: Avg Val MAE = 13.5534
No improvement in validation loss for 3 epochs.
We are in epoch (training):  7
Epoch 7: Avg Train Loss = 58.0478
Epoch 7: Avg Train MAE = 6.1275
We are in epoch (val):  7
Epoch 7: Avg Val Loss = 50.5859
Epoch 7: Avg Val MAE = 5.2479
Validation loss improved, saving best model.
We are in epoch (training):  8
Epoch 8: Avg Train Loss = 55.7901
Epoch 8: Avg Train MAE = 5.9022
We are in epoch (val):  8
Epoch 8: Avg Val Loss = 68.9288
Epoch 8: Avg Val MAE = 6.2511
No improvement in validation loss for 1 epochs.
We are in epoch (training):  9
Epoch 9: Avg Train Loss = 57.8405
Epoch 9: Avg Train MAE = 6.0538
We are in epoch (val):  9
Epoch 9: Avg Val Loss = 108.6762
Epoch 9: Avg Val MAE = 8.4586
No improvement in validation loss for 2 epochs.
We are in epoch (training):  10
Epoch 10: Avg Train Loss = 57.9272
Epoch 10: Avg Train MAE = 6.1347
We are in epoch (val):  10
Epoch 10: Avg Val Loss = 1092.3536
Epoch 10: Avg Val MAE = 32.2795
No improvement in validation loss for 3 epochs.
We are in epoch (training):  11
Epoch 11: Avg Train Loss = 56.5078
Epoch 11: Avg Train MAE = 6.0350
We are in epoch (val):  11
Epoch 11: Avg Val Loss = 112.6789
Epoch 11: Avg Val MAE = 9.3667
No improvement in validation loss for 4 epochs.
We are in epoch (training):  12
Epoch 12: Avg Train Loss = 56.1299
Epoch 12: Avg Train MAE = 6.0005
We are in epoch (val):  12
Epoch 12: Avg Val Loss = 143.3410
Epoch 12: Avg Val MAE = 10.8064
No improvement in validation loss for 5 epochs.
We are in epoch (training):  13
Epoch 13: Avg Train Loss = 53.9890
Epoch 13: Avg Train MAE = 5.8367
We are in epoch (val):  13
Epoch 13: Avg Val Loss = 185.6850
Epoch 13: Avg Val MAE = 12.0955
No improvement in validation loss for 6 epochs.
We are in epoch (training):  14
Epoch 14: Avg Train Loss = 51.9495
Epoch 14: Avg Train MAE = 5.7522
We are in epoch (val):  14
Epoch 14: Avg Val Loss = 68.8623
Epoch 14: Avg Val MAE = 7.1207
No improvement in validation loss for 7 epochs.
We are in epoch (training):  15
Epoch 15: Avg Train Loss = 53.5827
Epoch 15: Avg Train MAE = 5.9129
We are in epoch (val):  15
Epoch 15: Avg Val Loss = 77.0265
Epoch 15: Avg Val MAE = 7.5892
No improvement in validation loss for 8 epochs.
We are in epoch (training):  16
Epoch 16: Avg Train Loss = 52.4248
Epoch 16: Avg Train MAE = 5.7442
We are in epoch (val):  16
Epoch 16: Avg Val Loss = 43.8389
Epoch 16: Avg Val MAE = 4.9204
Validation loss improved, saving best model.
We are in epoch (training):  17
Epoch 17: Avg Train Loss = 58.6391
Epoch 17: Avg Train MAE = 6.0987
We are in epoch (val):  17
Epoch 17: Avg Val Loss = 126.4792
Epoch 17: Avg Val MAE = 10.0776
No improvement in validation loss for 1 epochs.
We are in epoch (training):  18
Epoch 18: Avg Train Loss = 52.3852
Epoch 18: Avg Train MAE = 5.8017
We are in epoch (val):  18
Epoch 18: Avg Val Loss = 333.6155
Epoch 18: Avg Val MAE = 17.1119
No improvement in validation loss for 2 epochs.
We are in epoch (training):  19
Epoch 19: Avg Train Loss = 51.5220
Epoch 19: Avg Train MAE = 5.7076
We are in epoch (val):  19
Epoch 19: Avg Val Loss = 274.4984
Epoch 19: Avg Val MAE = 15.2723
No improvement in validation loss for 3 epochs.
We are in epoch (training):  20
Epoch 20: Avg Train Loss = 52.7322
Epoch 20: Avg Train MAE = 5.8189
We are in epoch (val):  20
Epoch 20: Avg Val Loss = 159.3990
Epoch 20: Avg Val MAE = 11.0331
No improvement in validation loss for 4 epochs.
We are in epoch (training):  21
Epoch 21: Avg Train Loss = 50.0055
Epoch 21: Avg Train MAE = 5.6554
We are in epoch (val):  21
Epoch 21: Avg Val Loss = 132.8738
Epoch 21: Avg Val MAE = 10.3471
No improvement in validation loss for 5 epochs.
We are in epoch (training):  22
Epoch 22: Avg Train Loss = 49.1314
Epoch 22: Avg Train MAE = 5.5673
We are in epoch (val):  22
Epoch 22: Avg Val Loss = 72.6953
Epoch 22: Avg Val MAE = 7.3848
No improvement in validation loss for 6 epochs.
We are in epoch (training):  23
Epoch 23: Avg Train Loss = 49.1707
Epoch 23: Avg Train MAE = 5.6217
We are in epoch (val):  23
Epoch 23: Avg Val Loss = 117.7248
Epoch 23: Avg Val MAE = 9.0601
No improvement in validation loss for 7 epochs.
We are in epoch (training):  24
Epoch 24: Avg Train Loss = 45.9228
Epoch 24: Avg Train MAE = 5.3678
We are in epoch (val):  24
Epoch 24: Avg Val Loss = 156.6145
Epoch 24: Avg Val MAE = 10.9409
No improvement in validation loss for 8 epochs.
We are in epoch (training):  25
Epoch 25: Avg Train Loss = 48.2836
Epoch 25: Avg Train MAE = 5.4816
We are in epoch (val):  25
Epoch 25: Avg Val Loss = 383.0948
Epoch 25: Avg Val MAE = 18.5284
No improvement in validation loss for 9 epochs.
We are in epoch (training):  26
Epoch 26: Avg Train Loss = 46.8334
Epoch 26: Avg Train MAE = 5.4206
We are in epoch (val):  26
Epoch 26: Avg Val Loss = 49.7617
Epoch 26: Avg Val MAE = 5.2517
No improvement in validation loss for 10 epochs.
Early stopping triggered after 26 epochs.
Loaded the best model. Will now calculate predicted values on train and test set.
Loss plot (Train/Val) saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/CS_try/loss_plot_trainval.png
We are in test.
Loaded 294 images.
Loaded 294 rows of metadata.
Loaded 294 targets.
We are in test
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Test Loss (MSE): 47.0634
Test results saved to /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/CS_try/test_predicted_values.csv
Test MAE: 5.3544
