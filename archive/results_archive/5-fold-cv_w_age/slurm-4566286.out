This job can be monitored from: https://job.c3se.chalmers.se/alvis/4566286
We are in main.
Warning: Folder for participant sub-OAS30937 does not exist and will be deleted.
Warning: Folder for participant sub-OAS31357 does not exist and will be deleted.
Size of main data: 404
Size of test data: 102
We are in fold: 0
We are in train.
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30042 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Loaded 1435 image pairs.
Loaded 1435 rows of metadata.
Loaded 1435 targets.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Loaded 397 image pairs.
Loaded 397 rows of metadata.
Loaded 397 targets.
We are in epoch (training):  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Epoch 0: Avg Train Loss = 8.5692
Epoch 0: Avg Train MAE = 2.2430
We are in epoch (val):  0
Epoch 0: Avg Val Loss = 6.8435
Epoch 0: Avg Val MAE = 1.9828
Validation loss improved, saving best model.
We are in epoch (training):  1
Epoch 1: Avg Train Loss = 4.5276
Epoch 1: Avg Train MAE = 1.6565
We are in epoch (val):  1
Epoch 1: Avg Val Loss = 5.7468
Epoch 1: Avg Val MAE = 1.8023
Validation loss improved, saving best model.
We are in epoch (training):  2
Epoch 2: Avg Train Loss = 4.2836
Epoch 2: Avg Train MAE = 1.6034
We are in epoch (val):  2
Epoch 2: Avg Val Loss = 6.0943
Epoch 2: Avg Val MAE = 1.8870
No improvement in validation loss for 1 epochs.
We are in epoch (training):  3
Epoch 3: Avg Train Loss = 3.3970
Epoch 3: Avg Train MAE = 1.4334
We are in epoch (val):  3
Epoch 3: Avg Val Loss = 5.2519
Epoch 3: Avg Val MAE = 1.6913
Validation loss improved, saving best model.
We are in epoch (training):  4
Epoch 4: Avg Train Loss = 2.9858
Epoch 4: Avg Train MAE = 1.3424
We are in epoch (val):  4
Epoch 4: Avg Val Loss = 5.3732
Epoch 4: Avg Val MAE = 1.5909
No improvement in validation loss for 1 epochs.
We are in epoch (training):  5
Epoch 5: Avg Train Loss = 2.9616
Epoch 5: Avg Train MAE = 1.3449
We are in epoch (val):  5
Epoch 5: Avg Val Loss = 5.0538
Epoch 5: Avg Val MAE = 1.5927
Validation loss improved, saving best model.
We are in epoch (training):  6
Epoch 6: Avg Train Loss = 2.7086
Epoch 6: Avg Train MAE = 1.2796
We are in epoch (val):  6
Epoch 6: Avg Val Loss = 4.9428
Epoch 6: Avg Val MAE = 1.5263
Validation loss improved, saving best model.
We are in epoch (training):  7
Epoch 7: Avg Train Loss = 2.4940
Epoch 7: Avg Train MAE = 1.2302
We are in epoch (val):  7
Epoch 7: Avg Val Loss = 6.1241
Epoch 7: Avg Val MAE = 1.6273
No improvement in validation loss for 1 epochs.
We are in epoch (training):  8
Epoch 8: Avg Train Loss = 2.2053
Epoch 8: Avg Train MAE = 1.1500
We are in epoch (val):  8
Epoch 8: Avg Val Loss = 5.1762
Epoch 8: Avg Val MAE = 1.5253
No improvement in validation loss for 2 epochs.
We are in epoch (training):  9
Epoch 9: Avg Train Loss = 2.3292
Epoch 9: Avg Train MAE = 1.1830
We are in epoch (val):  9
Epoch 9: Avg Val Loss = 4.8229
Epoch 9: Avg Val MAE = 1.5887
Validation loss improved, saving best model.
We are in epoch (training):  10
Epoch 10: Avg Train Loss = 2.2035
Epoch 10: Avg Train MAE = 1.1565
We are in epoch (val):  10
Epoch 10: Avg Val Loss = 7.6872
Epoch 10: Avg Val MAE = 1.6572
No improvement in validation loss for 1 epochs.
We are in epoch (training):  11
Epoch 11: Avg Train Loss = 2.1084
Epoch 11: Avg Train MAE = 1.1157
We are in epoch (val):  11
Epoch 11: Avg Val Loss = 6.2066
Epoch 11: Avg Val MAE = 1.6280
No improvement in validation loss for 2 epochs.
We are in epoch (training):  12
Epoch 12: Avg Train Loss = 1.9704
Epoch 12: Avg Train MAE = 1.0921
We are in epoch (val):  12
Epoch 12: Avg Val Loss = 5.5059
Epoch 12: Avg Val MAE = 1.5140
No improvement in validation loss for 3 epochs.
We are in epoch (training):  13
Epoch 13: Avg Train Loss = 2.2125
Epoch 13: Avg Train MAE = 1.1358
We are in epoch (val):  13
Epoch 13: Avg Val Loss = 5.8997
Epoch 13: Avg Val MAE = 1.5735
No improvement in validation loss for 4 epochs.
We are in epoch (training):  14
Epoch 14: Avg Train Loss = 2.4381
Epoch 14: Avg Train MAE = 1.1800
We are in epoch (val):  14
Epoch 14: Avg Val Loss = 5.5934
Epoch 14: Avg Val MAE = 1.5606
No improvement in validation loss for 5 epochs.
We are in epoch (training):  15
Epoch 15: Avg Train Loss = 2.0761
Epoch 15: Avg Train MAE = 1.1159
We are in epoch (val):  15
Epoch 15: Avg Val Loss = 5.0093
Epoch 15: Avg Val MAE = 1.5352
No improvement in validation loss for 6 epochs.
We are in epoch (training):  16
Epoch 16: Avg Train Loss = 1.8964
Epoch 16: Avg Train MAE = 1.0686
We are in epoch (val):  16
Epoch 16: Avg Val Loss = 6.1446
Epoch 16: Avg Val MAE = 1.7197
No improvement in validation loss for 7 epochs.
We are in epoch (training):  17
Epoch 17: Avg Train Loss = 1.7804
Epoch 17: Avg Train MAE = 1.0329
We are in epoch (val):  17
Epoch 17: Avg Val Loss = 5.0688
Epoch 17: Avg Val MAE = 1.5036
No improvement in validation loss for 8 epochs.
We are in epoch (training):  18
Epoch 18: Avg Train Loss = 1.7173
Epoch 18: Avg Train MAE = 1.0003
We are in epoch (val):  18
Epoch 18: Avg Val Loss = 5.2225
Epoch 18: Avg Val MAE = 1.5429
No improvement in validation loss for 9 epochs.
We are in epoch (training):  19
Epoch 19: Avg Train Loss = 1.6642
Epoch 19: Avg Train MAE = 0.9887
We are in epoch (val):  19
Epoch 19: Avg Val Loss = 5.3221
Epoch 19: Avg Val MAE = 1.5191
No improvement in validation loss for 10 epochs.
Early stopping triggered after 19 epochs.
Loaded the best model. Will now calculate predicted values on train and test set.
Loss plot (Train/Val) saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/5-fold-cv_w_age/5-fold-cv_w_age/fold_0/loss_plot_trainval.png
We are in test.
Loaded 510 image pairs.
Loaded 510 rows of metadata.
Loaded 510 targets.
We are in test
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Test Loss (MSE): 4.1646
Test results saved to /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/5-fold-cv_w_age/5-fold-cv_w_age/fold_0/test_predicted_values.csv
Test MAE: 1.5096
We are in fold: 1
We are in train.
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30042 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Loaded 1481 image pairs.
Loaded 1481 rows of metadata.
Loaded 1481 targets.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Loaded 351 image pairs.
Loaded 351 rows of metadata.
Loaded 351 targets.
We are in epoch (training):  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Epoch 0: Avg Train Loss = 8.4288
Epoch 0: Avg Train MAE = 2.2008
We are in epoch (val):  0
Epoch 0: Avg Val Loss = 5.7544
Epoch 0: Avg Val MAE = 1.8792
Validation loss improved, saving best model.
We are in epoch (training):  1
Epoch 1: Avg Train Loss = 4.9339
Epoch 1: Avg Train MAE = 1.7583
We are in epoch (val):  1
Epoch 1: Avg Val Loss = 3.6191
Epoch 1: Avg Val MAE = 1.5510
Validation loss improved, saving best model.
We are in epoch (training):  2
Epoch 2: Avg Train Loss = 4.1428
Epoch 2: Avg Train MAE = 1.5942
We are in epoch (val):  2
Epoch 2: Avg Val Loss = 3.4987
Epoch 2: Avg Val MAE = 1.5244
Validation loss improved, saving best model.
We are in epoch (training):  3
Epoch 3: Avg Train Loss = 3.5064
Epoch 3: Avg Train MAE = 1.4723
We are in epoch (val):  3
Epoch 3: Avg Val Loss = 3.5312
Epoch 3: Avg Val MAE = 1.4935
No improvement in validation loss for 1 epochs.
We are in epoch (training):  4
Epoch 4: Avg Train Loss = 3.0441
Epoch 4: Avg Train MAE = 1.3646
We are in epoch (val):  4
Epoch 4: Avg Val Loss = 3.3554
Epoch 4: Avg Val MAE = 1.4551
Validation loss improved, saving best model.
We are in epoch (training):  5
Epoch 5: Avg Train Loss = 2.7292
Epoch 5: Avg Train MAE = 1.3083
We are in epoch (val):  5
Epoch 5: Avg Val Loss = 2.9996
Epoch 5: Avg Val MAE = 1.3909
Validation loss improved, saving best model.
We are in epoch (training):  6
Epoch 6: Avg Train Loss = 2.6096
Epoch 6: Avg Train MAE = 1.2578
We are in epoch (val):  6
Epoch 6: Avg Val Loss = 3.0231
Epoch 6: Avg Val MAE = 1.3652
No improvement in validation loss for 1 epochs.
We are in epoch (training):  7
Epoch 7: Avg Train Loss = 2.5229
Epoch 7: Avg Train MAE = 1.2390
We are in epoch (val):  7
Epoch 7: Avg Val Loss = 3.6035
Epoch 7: Avg Val MAE = 1.4117
No improvement in validation loss for 2 epochs.
We are in epoch (training):  8
Epoch 8: Avg Train Loss = 2.3051
Epoch 8: Avg Train MAE = 1.1721
We are in epoch (val):  8
Epoch 8: Avg Val Loss = 3.2455
Epoch 8: Avg Val MAE = 1.4283
No improvement in validation loss for 3 epochs.
We are in epoch (training):  9
Epoch 9: Avg Train Loss = 2.2742
Epoch 9: Avg Train MAE = 1.1868
We are in epoch (val):  9
Epoch 9: Avg Val Loss = 2.9790
Epoch 9: Avg Val MAE = 1.3369
Validation loss improved, saving best model.
We are in epoch (training):  10
Epoch 10: Avg Train Loss = 1.9798
Epoch 10: Avg Train MAE = 1.0945
We are in epoch (val):  10
Epoch 10: Avg Val Loss = 3.1900
Epoch 10: Avg Val MAE = 1.3507
No improvement in validation loss for 1 epochs.
We are in epoch (training):  11
Epoch 11: Avg Train Loss = 2.5518
Epoch 11: Avg Train MAE = 1.2063
We are in epoch (val):  11
Epoch 11: Avg Val Loss = 3.0592
Epoch 11: Avg Val MAE = 1.3407
No improvement in validation loss for 2 epochs.
We are in epoch (training):  12
Epoch 12: Avg Train Loss = 1.9054
Epoch 12: Avg Train MAE = 1.0839
We are in epoch (val):  12
Epoch 12: Avg Val Loss = 3.2842
Epoch 12: Avg Val MAE = 1.3919
No improvement in validation loss for 3 epochs.
We are in epoch (training):  13
Epoch 13: Avg Train Loss = 1.8606
Epoch 13: Avg Train MAE = 1.0588
We are in epoch (val):  13
Epoch 13: Avg Val Loss = 3.1132
Epoch 13: Avg Val MAE = 1.3587
No improvement in validation loss for 4 epochs.
We are in epoch (training):  14
Epoch 14: Avg Train Loss = 1.8791
Epoch 14: Avg Train MAE = 1.0632
We are in epoch (val):  14
Epoch 14: Avg Val Loss = 2.9891
Epoch 14: Avg Val MAE = 1.3237
No improvement in validation loss for 5 epochs.
We are in epoch (training):  15
Epoch 15: Avg Train Loss = 1.7579
Epoch 15: Avg Train MAE = 1.0341
We are in epoch (val):  15
Epoch 15: Avg Val Loss = 3.0109
Epoch 15: Avg Val MAE = 1.3174
No improvement in validation loss for 6 epochs.
We are in epoch (training):  16
Epoch 16: Avg Train Loss = 1.6604
Epoch 16: Avg Train MAE = 1.0024
We are in epoch (val):  16
Epoch 16: Avg Val Loss = 3.1741
Epoch 16: Avg Val MAE = 1.3579
No improvement in validation loss for 7 epochs.
We are in epoch (training):  17
Epoch 17: Avg Train Loss = 1.6355
Epoch 17: Avg Train MAE = 0.9916
We are in epoch (val):  17
Epoch 17: Avg Val Loss = 4.0392
Epoch 17: Avg Val MAE = 1.4286
No improvement in validation loss for 8 epochs.
We are in epoch (training):  18
Epoch 18: Avg Train Loss = 1.6936
Epoch 18: Avg Train MAE = 1.0101
We are in epoch (val):  18
Epoch 18: Avg Val Loss = 3.1360
Epoch 18: Avg Val MAE = 1.3245
No improvement in validation loss for 9 epochs.
We are in epoch (training):  19
Epoch 19: Avg Train Loss = 1.6930
Epoch 19: Avg Train MAE = 1.0003
We are in epoch (val):  19
Epoch 19: Avg Val Loss = 3.1817
Epoch 19: Avg Val MAE = 1.3451
No improvement in validation loss for 10 epochs.
Early stopping triggered after 19 epochs.
Loaded the best model. Will now calculate predicted values on train and test set.
Loss plot (Train/Val) saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/5-fold-cv_w_age/5-fold-cv_w_age/fold_1/loss_plot_trainval.png
We are in test.
Loaded 510 image pairs.
Loaded 510 rows of metadata.
Loaded 510 targets.
We are in test
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Test Loss (MSE): 4.0310
Test results saved to /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/5-fold-cv_w_age/5-fold-cv_w_age/fold_1/test_predicted_values.csv
Test MAE: 1.4986
We are in fold: 2
We are in train.
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Loaded 1461 image pairs.
Loaded 1461 rows of metadata.
Loaded 1461 targets.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30042 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Loaded 371 image pairs.
Loaded 371 rows of metadata.
Loaded 371 targets.
We are in epoch (training):  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Epoch 0: Avg Train Loss = 8.1525
Epoch 0: Avg Train MAE = 2.1698
We are in epoch (val):  0
Epoch 0: Avg Val Loss = 6.2568
Epoch 0: Avg Val MAE = 1.8799
Validation loss improved, saving best model.
We are in epoch (training):  1
Epoch 1: Avg Train Loss = 4.5331
Epoch 1: Avg Train MAE = 1.6643
We are in epoch (val):  1
Epoch 1: Avg Val Loss = 3.9555
Epoch 1: Avg Val MAE = 1.5492
Validation loss improved, saving best model.
We are in epoch (training):  2
Epoch 2: Avg Train Loss = 4.2954
Epoch 2: Avg Train MAE = 1.6275
We are in epoch (val):  2
Epoch 2: Avg Val Loss = 3.5444
Epoch 2: Avg Val MAE = 1.5064
Validation loss improved, saving best model.
We are in epoch (training):  3
Epoch 3: Avg Train Loss = 3.4453
Epoch 3: Avg Train MAE = 1.4565
We are in epoch (val):  3
Epoch 3: Avg Val Loss = 3.5423
Epoch 3: Avg Val MAE = 1.4543
Validation loss improved, saving best model.
We are in epoch (training):  4
Epoch 4: Avg Train Loss = 3.0204
Epoch 4: Avg Train MAE = 1.3578
We are in epoch (val):  4
Epoch 4: Avg Val Loss = 3.5006
Epoch 4: Avg Val MAE = 1.4330
Validation loss improved, saving best model.
We are in epoch (training):  5
Epoch 5: Avg Train Loss = 2.9082
Epoch 5: Avg Train MAE = 1.3389
We are in epoch (val):  5
Epoch 5: Avg Val Loss = 3.1034
Epoch 5: Avg Val MAE = 1.3649
Validation loss improved, saving best model.
We are in epoch (training):  6
Epoch 6: Avg Train Loss = 2.6657
Epoch 6: Avg Train MAE = 1.2761
We are in epoch (val):  6
Epoch 6: Avg Val Loss = 3.4066
Epoch 6: Avg Val MAE = 1.3939
No improvement in validation loss for 1 epochs.
We are in epoch (training):  7
Epoch 7: Avg Train Loss = 2.6644
Epoch 7: Avg Train MAE = 1.2736
We are in epoch (val):  7
Epoch 7: Avg Val Loss = 3.3521
Epoch 7: Avg Val MAE = 1.4083
No improvement in validation loss for 2 epochs.
We are in epoch (training):  8
Epoch 8: Avg Train Loss = 2.3694
Epoch 8: Avg Train MAE = 1.2127
We are in epoch (val):  8
Epoch 8: Avg Val Loss = 3.6785
Epoch 8: Avg Val MAE = 1.3877
No improvement in validation loss for 3 epochs.
We are in epoch (training):  9
Epoch 9: Avg Train Loss = 2.3732
Epoch 9: Avg Train MAE = 1.2167
We are in epoch (val):  9
Epoch 9: Avg Val Loss = 3.0991
Epoch 9: Avg Val MAE = 1.3309
Validation loss improved, saving best model.
We are in epoch (training):  10
Epoch 10: Avg Train Loss = 2.3673
Epoch 10: Avg Train MAE = 1.2057
We are in epoch (val):  10
Epoch 10: Avg Val Loss = 3.9898
Epoch 10: Avg Val MAE = 1.4254
No improvement in validation loss for 1 epochs.
We are in epoch (training):  11
Epoch 11: Avg Train Loss = 2.1842
Epoch 11: Avg Train MAE = 1.1688
We are in epoch (val):  11
Epoch 11: Avg Val Loss = 3.7694
Epoch 11: Avg Val MAE = 1.4799
No improvement in validation loss for 2 epochs.
We are in epoch (training):  12
Epoch 12: Avg Train Loss = 1.9267
Epoch 12: Avg Train MAE = 1.0864
We are in epoch (val):  12
Epoch 12: Avg Val Loss = 3.1236
Epoch 12: Avg Val MAE = 1.3047
No improvement in validation loss for 3 epochs.
We are in epoch (training):  13
Epoch 13: Avg Train Loss = 1.9220
Epoch 13: Avg Train MAE = 1.0917
We are in epoch (val):  13
Epoch 13: Avg Val Loss = 3.5228
Epoch 13: Avg Val MAE = 1.3810
No improvement in validation loss for 4 epochs.
We are in epoch (training):  14
Epoch 14: Avg Train Loss = 2.0114
Epoch 14: Avg Train MAE = 1.1147
We are in epoch (val):  14
Epoch 14: Avg Val Loss = 3.6128
Epoch 14: Avg Val MAE = 1.3862
No improvement in validation loss for 5 epochs.
We are in epoch (training):  15
Epoch 15: Avg Train Loss = 1.8849
Epoch 15: Avg Train MAE = 1.0854
We are in epoch (val):  15
Epoch 15: Avg Val Loss = 3.6592
Epoch 15: Avg Val MAE = 1.3951
No improvement in validation loss for 6 epochs.
We are in epoch (training):  16
Epoch 16: Avg Train Loss = 1.8161
Epoch 16: Avg Train MAE = 1.0654
We are in epoch (val):  16
Epoch 16: Avg Val Loss = 3.5921
Epoch 16: Avg Val MAE = 1.3845
No improvement in validation loss for 7 epochs.
We are in epoch (training):  17
Epoch 17: Avg Train Loss = 1.7185
Epoch 17: Avg Train MAE = 1.0267
We are in epoch (val):  17
Epoch 17: Avg Val Loss = 3.5899
Epoch 17: Avg Val MAE = 1.3891
No improvement in validation loss for 8 epochs.
We are in epoch (training):  18
Epoch 18: Avg Train Loss = 1.5990
Epoch 18: Avg Train MAE = 1.0034
We are in epoch (val):  18
Epoch 18: Avg Val Loss = 4.3360
Epoch 18: Avg Val MAE = 1.4470
No improvement in validation loss for 9 epochs.
We are in epoch (training):  19
Epoch 19: Avg Train Loss = 1.7914
Epoch 19: Avg Train MAE = 1.0490
We are in epoch (val):  19
Epoch 19: Avg Val Loss = 3.4414
Epoch 19: Avg Val MAE = 1.3839
No improvement in validation loss for 10 epochs.
Early stopping triggered after 19 epochs.
Loaded the best model. Will now calculate predicted values on train and test set.
Loss plot (Train/Val) saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/5-fold-cv_w_age/5-fold-cv_w_age/fold_2/loss_plot_trainval.png
We are in test.
Loaded 510 image pairs.
Loaded 510 rows of metadata.
Loaded 510 targets.
We are in test
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Test Loss (MSE): 3.6386
Test results saved to /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/5-fold-cv_w_age/5-fold-cv_w_age/fold_2/test_predicted_values.csv
Test MAE: 1.4765
We are in fold: 3
We are in train.
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30042 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Loaded 1453 image pairs.
Loaded 1453 rows of metadata.
Loaded 1453 targets.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Loaded 379 image pairs.
Loaded 379 rows of metadata.
Loaded 379 targets.
We are in epoch (training):  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Epoch 0: Avg Train Loss = 8.5826
Epoch 0: Avg Train MAE = 2.2362
We are in epoch (val):  0
Epoch 0: Avg Val Loss = 5.4736
Epoch 0: Avg Val MAE = 1.7725
Validation loss improved, saving best model.
We are in epoch (training):  1
Epoch 1: Avg Train Loss = 4.5541
Epoch 1: Avg Train MAE = 1.6578
We are in epoch (val):  1
Epoch 1: Avg Val Loss = 4.4679
Epoch 1: Avg Val MAE = 1.5982
Validation loss improved, saving best model.
We are in epoch (training):  2
Epoch 2: Avg Train Loss = 3.4801
Epoch 2: Avg Train MAE = 1.4696
We are in epoch (val):  2
Epoch 2: Avg Val Loss = 5.2305
Epoch 2: Avg Val MAE = 1.6963
No improvement in validation loss for 1 epochs.
We are in epoch (training):  3
Epoch 3: Avg Train Loss = 3.1390
Epoch 3: Avg Train MAE = 1.4026
We are in epoch (val):  3
Epoch 3: Avg Val Loss = 5.0597
Epoch 3: Avg Val MAE = 1.5879
No improvement in validation loss for 2 epochs.
We are in epoch (training):  4
Epoch 4: Avg Train Loss = 3.1837
Epoch 4: Avg Train MAE = 1.3919
We are in epoch (val):  4
Epoch 4: Avg Val Loss = 4.7329
Epoch 4: Avg Val MAE = 1.5943
No improvement in validation loss for 3 epochs.
We are in epoch (training):  5
Epoch 5: Avg Train Loss = 2.7791
Epoch 5: Avg Train MAE = 1.3014
We are in epoch (val):  5
Epoch 5: Avg Val Loss = 5.0244
Epoch 5: Avg Val MAE = 1.6088
No improvement in validation loss for 4 epochs.
We are in epoch (training):  6
Epoch 6: Avg Train Loss = 2.8104
Epoch 6: Avg Train MAE = 1.2989
We are in epoch (val):  6
Epoch 6: Avg Val Loss = 5.3990
Epoch 6: Avg Val MAE = 1.5906
No improvement in validation loss for 5 epochs.
We are in epoch (training):  7
Epoch 7: Avg Train Loss = 2.5327
Epoch 7: Avg Train MAE = 1.2371
We are in epoch (val):  7
Epoch 7: Avg Val Loss = 5.2919
Epoch 7: Avg Val MAE = 1.5340
No improvement in validation loss for 6 epochs.
We are in epoch (training):  8
Epoch 8: Avg Train Loss = 2.2987
Epoch 8: Avg Train MAE = 1.1879
We are in epoch (val):  8
Epoch 8: Avg Val Loss = 5.1080
Epoch 8: Avg Val MAE = 1.5281
No improvement in validation loss for 7 epochs.
We are in epoch (training):  9
Epoch 9: Avg Train Loss = 2.2544
Epoch 9: Avg Train MAE = 1.1633
We are in epoch (val):  9
Epoch 9: Avg Val Loss = 5.0182
Epoch 9: Avg Val MAE = 1.5063
No improvement in validation loss for 8 epochs.
We are in epoch (training):  10
Epoch 10: Avg Train Loss = 2.0971
Epoch 10: Avg Train MAE = 1.1341
We are in epoch (val):  10
Epoch 10: Avg Val Loss = 5.6672
Epoch 10: Avg Val MAE = 1.5767
No improvement in validation loss for 9 epochs.
We are in epoch (training):  11
Epoch 11: Avg Train Loss = 2.0031
Epoch 11: Avg Train MAE = 1.1138
We are in epoch (val):  11
Epoch 11: Avg Val Loss = 5.4218
Epoch 11: Avg Val MAE = 1.5620
No improvement in validation loss for 10 epochs.
Early stopping triggered after 11 epochs.
Loaded the best model. Will now calculate predicted values on train and test set.
Loss plot (Train/Val) saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/5-fold-cv_w_age/5-fold-cv_w_age/fold_3/loss_plot_trainval.png
We are in test.
Loaded 510 image pairs.
Loaded 510 rows of metadata.
Loaded 510 targets.
We are in test
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Test Loss (MSE): 3.9231
Test results saved to /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/5-fold-cv_w_age/5-fold-cv_w_age/fold_3/test_predicted_values.csv
Test MAE: 1.4909
We are in fold: 4
We are in train.
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30042 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Loaded 1498 image pairs.
Loaded 1498 rows of metadata.
Loaded 1498 targets.
Loaded 334 image pairs.
Loaded 334 rows of metadata.
Loaded 334 targets.
We are in epoch (training):  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Epoch 0: Avg Train Loss = 9.6673
Epoch 0: Avg Train MAE = 2.3860
We are in epoch (val):  0
Epoch 0: Avg Val Loss = 6.2683
Epoch 0: Avg Val MAE = 1.8900
Validation loss improved, saving best model.
We are in epoch (training):  1
Epoch 1: Avg Train Loss = 4.2790
Epoch 1: Avg Train MAE = 1.6154
We are in epoch (val):  1
Epoch 1: Avg Val Loss = 5.2893
Epoch 1: Avg Val MAE = 1.7506
Validation loss improved, saving best model.
We are in epoch (training):  2
Epoch 2: Avg Train Loss = 3.7048
Epoch 2: Avg Train MAE = 1.5079
We are in epoch (val):  2
Epoch 2: Avg Val Loss = 4.0828
Epoch 2: Avg Val MAE = 1.6057
Validation loss improved, saving best model.
We are in epoch (training):  3
Epoch 3: Avg Train Loss = 3.8541
Epoch 3: Avg Train MAE = 1.5271
We are in epoch (val):  3
Epoch 3: Avg Val Loss = 4.1476
Epoch 3: Avg Val MAE = 1.6117
No improvement in validation loss for 1 epochs.
We are in epoch (training):  4
Epoch 4: Avg Train Loss = 3.0779
Epoch 4: Avg Train MAE = 1.3787
We are in epoch (val):  4
Epoch 4: Avg Val Loss = 3.6743
Epoch 4: Avg Val MAE = 1.5150
Validation loss improved, saving best model.
We are in epoch (training):  5
Epoch 5: Avg Train Loss = 2.7202
Epoch 5: Avg Train MAE = 1.2964
We are in epoch (val):  5
Epoch 5: Avg Val Loss = 3.5567
Epoch 5: Avg Val MAE = 1.4779
Validation loss improved, saving best model.
We are in epoch (training):  6
Epoch 6: Avg Train Loss = 2.7619
Epoch 6: Avg Train MAE = 1.3045
We are in epoch (val):  6
Epoch 6: Avg Val Loss = 3.3914
Epoch 6: Avg Val MAE = 1.4458
Validation loss improved, saving best model.
We are in epoch (training):  7
Epoch 7: Avg Train Loss = 2.4632
Epoch 7: Avg Train MAE = 1.2368
We are in epoch (val):  7
Epoch 7: Avg Val Loss = 3.3840
Epoch 7: Avg Val MAE = 1.4049
Validation loss improved, saving best model.
We are in epoch (training):  8
Epoch 8: Avg Train Loss = 2.3466
Epoch 8: Avg Train MAE = 1.2030
We are in epoch (val):  8
Epoch 8: Avg Val Loss = 3.4272
Epoch 8: Avg Val MAE = 1.4322
No improvement in validation loss for 1 epochs.
We are in epoch (training):  9
Epoch 9: Avg Train Loss = 2.3380
Epoch 9: Avg Train MAE = 1.2043
We are in epoch (val):  9
Epoch 9: Avg Val Loss = 3.5324
Epoch 9: Avg Val MAE = 1.4172
No improvement in validation loss for 2 epochs.
We are in epoch (training):  10
Epoch 10: Avg Train Loss = 2.1247
Epoch 10: Avg Train MAE = 1.1507
We are in epoch (val):  10
Epoch 10: Avg Val Loss = 3.1062
Epoch 10: Avg Val MAE = 1.3672
Validation loss improved, saving best model.
We are in epoch (training):  11
Epoch 11: Avg Train Loss = 2.1093
Epoch 11: Avg Train MAE = 1.1304
We are in epoch (val):  11
Epoch 11: Avg Val Loss = 3.1412
Epoch 11: Avg Val MAE = 1.3795
No improvement in validation loss for 1 epochs.
We are in epoch (training):  12
Epoch 12: Avg Train Loss = 2.0272
Epoch 12: Avg Train MAE = 1.1092
We are in epoch (val):  12
Epoch 12: Avg Val Loss = 3.2147
Epoch 12: Avg Val MAE = 1.3767
No improvement in validation loss for 2 epochs.
We are in epoch (training):  13
Epoch 13: Avg Train Loss = 1.9442
Epoch 13: Avg Train MAE = 1.0980
We are in epoch (val):  13
Epoch 13: Avg Val Loss = 3.2703
Epoch 13: Avg Val MAE = 1.3965
No improvement in validation loss for 3 epochs.
We are in epoch (training):  14
Epoch 14: Avg Train Loss = 1.8109
Epoch 14: Avg Train MAE = 1.0502
We are in epoch (val):  14
Epoch 14: Avg Val Loss = 3.3966
Epoch 14: Avg Val MAE = 1.4295
No improvement in validation loss for 4 epochs.
We are in epoch (training):  15
Epoch 15: Avg Train Loss = 1.8389
Epoch 15: Avg Train MAE = 1.0458
We are in epoch (val):  15
Epoch 15: Avg Val Loss = 3.1467
Epoch 15: Avg Val MAE = 1.3563
No improvement in validation loss for 5 epochs.
We are in epoch (training):  16
Epoch 16: Avg Train Loss = 1.6952
Epoch 16: Avg Train MAE = 1.0268
We are in epoch (val):  16
Epoch 16: Avg Val Loss = 3.2481
Epoch 16: Avg Val MAE = 1.3986
No improvement in validation loss for 6 epochs.
We are in epoch (training):  17
Epoch 17: Avg Train Loss = 1.7688
Epoch 17: Avg Train MAE = 1.0271
We are in epoch (val):  17
Epoch 17: Avg Val Loss = 3.1136
Epoch 17: Avg Val MAE = 1.3657
No improvement in validation loss for 7 epochs.
We are in epoch (training):  18
Epoch 18: Avg Train Loss = 1.6690
Epoch 18: Avg Train MAE = 1.0065
We are in epoch (val):  18
Epoch 18: Avg Val Loss = 3.3045
Epoch 18: Avg Val MAE = 1.3717
No improvement in validation loss for 8 epochs.
We are in epoch (training):  19
Epoch 19: Avg Train Loss = 1.6118
Epoch 19: Avg Train MAE = 0.9786
We are in epoch (val):  19
Epoch 19: Avg Val Loss = 3.3159
Epoch 19: Avg Val MAE = 1.3863
No improvement in validation loss for 9 epochs.
We are in epoch (training):  20
Epoch 20: Avg Train Loss = 1.4934
Epoch 20: Avg Train MAE = 0.9504
We are in epoch (val):  20
Epoch 20: Avg Val Loss = 3.7449
Epoch 20: Avg Val MAE = 1.4776
No improvement in validation loss for 10 epochs.
Early stopping triggered after 20 epochs.
Loaded the best model. Will now calculate predicted values on train and test set.
Loss plot (Train/Val) saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/5-fold-cv_w_age/5-fold-cv_w_age/fold_4/loss_plot_trainval.png
We are in test.
Loaded 510 image pairs.
Loaded 510 rows of metadata.
Loaded 510 targets.
We are in test
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Test Loss (MSE): 4.4294
Test results saved to /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/5-fold-cv_w_age/5-fold-cv_w_age/fold_4/test_predicted_values.csv
Test MAE: 1.5647
