This job can be monitored from: https://job.c3se.chalmers.se/alvis/4584476
We are in main.
Warning: Folder for participant sub-OAS30937 does not exist and will be deleted.
Warning: Folder for participant sub-OAS31357 does not exist and will be deleted.
Train size (number of participants): 592, Validation size: 198, Test size: 198
We are in train.
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Loaded 297 images.
Loaded 297 rows of metadata.
Loaded 297 targets.
Loaded 103 images.
Loaded 103 rows of metadata.
Loaded 103 targets.
We are in epoch (training):  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Epoch 0: Avg Train Loss = 1704.7685
Epoch 0: Avg Train MAE = 35.9975
We are in epoch (val):  0
Epoch 0: Avg Val Loss = 332.6046
Epoch 0: Avg Val MAE = 15.9255
Validation loss improved, saving best model.
We are in epoch (training):  1
Epoch 1: Avg Train Loss = 203.4760
Epoch 1: Avg Train MAE = 11.4641
We are in epoch (val):  1
Epoch 1: Avg Val Loss = 117.9248
Epoch 1: Avg Val MAE = 8.4120
Validation loss improved, saving best model.
We are in epoch (training):  2
Epoch 2: Avg Train Loss = 160.2121
Epoch 2: Avg Train MAE = 9.8294
We are in epoch (val):  2
Epoch 2: Avg Val Loss = 100.3139
Epoch 2: Avg Val MAE = 7.8451
Validation loss improved, saving best model.
We are in epoch (training):  3
Epoch 3: Avg Train Loss = 151.7102
Epoch 3: Avg Train MAE = 9.9549
We are in epoch (val):  3
Epoch 3: Avg Val Loss = 96.9276
Epoch 3: Avg Val MAE = 7.8666
Validation loss improved, saving best model.
We are in epoch (training):  4
Epoch 4: Avg Train Loss = 124.5331
Epoch 4: Avg Train MAE = 8.6327
We are in epoch (val):  4
Epoch 4: Avg Val Loss = 92.0753
Epoch 4: Avg Val MAE = 7.5297
Validation loss improved, saving best model.
We are in epoch (training):  5
Epoch 5: Avg Train Loss = 127.3679
Epoch 5: Avg Train MAE = 8.9124
We are in epoch (val):  5
Epoch 5: Avg Val Loss = 134.1792
Epoch 5: Avg Val MAE = 9.6224
No improvement in validation loss for 1 epochs.
We are in epoch (training):  6
Epoch 6: Avg Train Loss = 124.7258
Epoch 6: Avg Train MAE = 8.6747
We are in epoch (val):  6
Epoch 6: Avg Val Loss = 82.5157
Epoch 6: Avg Val MAE = 7.1771
Validation loss improved, saving best model.
We are in epoch (training):  7
Epoch 7: Avg Train Loss = 121.9394
Epoch 7: Avg Train MAE = 8.8984
We are in epoch (val):  7
Epoch 7: Avg Val Loss = 79.9928
Epoch 7: Avg Val MAE = 7.0879
Validation loss improved, saving best model.
We are in epoch (training):  8
Epoch 8: Avg Train Loss = 129.2874
Epoch 8: Avg Train MAE = 9.0012
We are in epoch (val):  8
Epoch 8: Avg Val Loss = 97.6080
Epoch 8: Avg Val MAE = 7.7141
No improvement in validation loss for 1 epochs.
We are in epoch (training):  9
Epoch 9: Avg Train Loss = 123.0391
Epoch 9: Avg Train MAE = 8.8911
We are in epoch (val):  9
Epoch 9: Avg Val Loss = 89.1434
Epoch 9: Avg Val MAE = 7.6172
No improvement in validation loss for 2 epochs.
We are in epoch (training):  10
Epoch 10: Avg Train Loss = 118.3718
Epoch 10: Avg Train MAE = 8.5422
We are in epoch (val):  10
Epoch 10: Avg Val Loss = 69.2262
Epoch 10: Avg Val MAE = 6.6150
Validation loss improved, saving best model.
We are in epoch (training):  11
Epoch 11: Avg Train Loss = 119.3085
Epoch 11: Avg Train MAE = 8.6958
We are in epoch (val):  11
Epoch 11: Avg Val Loss = 70.1332
Epoch 11: Avg Val MAE = 6.5112
No improvement in validation loss for 1 epochs.
We are in epoch (training):  12
Epoch 12: Avg Train Loss = 127.9841
Epoch 12: Avg Train MAE = 9.1438
We are in epoch (val):  12
Epoch 12: Avg Val Loss = 111.2477
Epoch 12: Avg Val MAE = 8.5923
No improvement in validation loss for 2 epochs.
We are in epoch (training):  13
Epoch 13: Avg Train Loss = 102.6332
Epoch 13: Avg Train MAE = 8.0177
We are in epoch (val):  13
Epoch 13: Avg Val Loss = 84.9498
Epoch 13: Avg Val MAE = 7.5346
No improvement in validation loss for 3 epochs.
We are in epoch (training):  14
Epoch 14: Avg Train Loss = 111.9418
Epoch 14: Avg Train MAE = 8.2248
We are in epoch (val):  14
Epoch 14: Avg Val Loss = 73.1654
Epoch 14: Avg Val MAE = 6.5711
No improvement in validation loss for 4 epochs.
We are in epoch (training):  15
Epoch 15: Avg Train Loss = 109.4454
Epoch 15: Avg Train MAE = 8.3306
We are in epoch (val):  15
Epoch 15: Avg Val Loss = 85.8270
Epoch 15: Avg Val MAE = 7.1313
No improvement in validation loss for 5 epochs.
We are in epoch (training):  16
Epoch 16: Avg Train Loss = 96.8534
Epoch 16: Avg Train MAE = 7.8072
We are in epoch (val):  16
Epoch 16: Avg Val Loss = 70.8578
Epoch 16: Avg Val MAE = 6.4434
No improvement in validation loss for 6 epochs.
We are in epoch (training):  17
Epoch 17: Avg Train Loss = 104.7598
Epoch 17: Avg Train MAE = 8.2615
We are in epoch (val):  17
Epoch 17: Avg Val Loss = 72.0021
Epoch 17: Avg Val MAE = 6.7593
No improvement in validation loss for 7 epochs.
We are in epoch (training):  18
Epoch 18: Avg Train Loss = 113.5472
Epoch 18: Avg Train MAE = 8.3446
We are in epoch (val):  18
Epoch 18: Avg Val Loss = 86.8419
Epoch 18: Avg Val MAE = 7.1784
No improvement in validation loss for 8 epochs.
We are in epoch (training):  19
Epoch 19: Avg Train Loss = 110.8815
Epoch 19: Avg Train MAE = 8.2915
We are in epoch (val):  19
Epoch 19: Avg Val Loss = 80.2793
Epoch 19: Avg Val MAE = 7.1699
No improvement in validation loss for 9 epochs.
We are in epoch (training):  20
Epoch 20: Avg Train Loss = 104.3710
Epoch 20: Avg Train MAE = 8.1305
We are in epoch (val):  20
Epoch 20: Avg Val Loss = 72.2409
Epoch 20: Avg Val MAE = 6.8780
No improvement in validation loss for 10 epochs.
Early stopping triggered after 20 epochs.
Loaded the best model. Will now calculate predicted values on train and test set.
Loss plot (Train/Val) saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/CS_model/loss_plot_trainval.png
We are in test.
Loaded 100 images.
Loaded 100 rows of metadata.
Loaded 100 targets.
We are in test
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Test Loss (MSE): 64.0149
Test results saved to /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/CS_model/test_predicted_values.csv
Test MAE: 6.5730
