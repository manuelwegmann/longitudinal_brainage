This job can be monitored from: https://job.c3se.chalmers.se/alvis/4792862
Fold: 0
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Warning: No matching T1w image found for sub-OAS30042 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Loaded 1588 image pairs.
Loaded 1588 rows of metadata.
Loaded 1588 targets.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Loaded 451 image pairs.
Loaded 451 rows of metadata.
Loaded 451 targets.
Epoch:  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Avg Train Loss/MAE = 6.2155 / 1.9009. Weights were updated.
Avg Val Loss/MAE = 7.1272 / 2.1367
Current learning rate: 0.001
Epoch:  1
Avg Train Loss/MAE = 3.7354 / 1.4947. Weights were updated.
Avg Val Loss/MAE = 5.6214 / 1.8897
Current learning rate: 0.001
Epoch:  2
Avg Train Loss/MAE = 2.7466 / 1.2783. Weights were updated.
Avg Val Loss/MAE = 4.2379 / 1.6269
Current learning rate: 0.001
Epoch:  3
Avg Train Loss/MAE = 2.6631 / 1.2818. Weights were updated.
Avg Val Loss/MAE = 4.4669 / 1.6596
Current learning rate: 0.001
Epoch:  4
Avg Train Loss/MAE = 2.3328 / 1.1932. Weights were updated.
Avg Val Loss/MAE = 3.3228 / 1.4301
Current learning rate: 0.001
Epoch:  5
Avg Train Loss/MAE = 1.9805 / 1.0941. Weights were updated.
Avg Val Loss/MAE = 3.2620 / 1.3918
Current learning rate: 0.001
Epoch:  6
Avg Train Loss/MAE = 1.8305 / 1.0575. Weights were updated.
Avg Val Loss/MAE = 2.8439 / 1.2747
Current learning rate: 0.001
Epoch:  7
Avg Train Loss/MAE = 1.6821 / 1.0252. Weights were updated.
Avg Val Loss/MAE = 2.6190 / 1.2398
Current learning rate: 0.001
Epoch:  8
Avg Train Loss/MAE = 1.6260 / 1.0047. Weights were updated.
Avg Val Loss/MAE = 2.3883 / 1.1891
Current learning rate: 0.001
Epoch:  9
Avg Train Loss/MAE = 1.5375 / 0.9730. Weights were updated.
Avg Val Loss/MAE = 2.6070 / 1.2324
Current learning rate: 0.001
Epoch:  10
Avg Train Loss/MAE = 1.4743 / 0.9580. Weights were updated.
Avg Val Loss/MAE = 2.9890 / 1.3415
Current learning rate: 0.001
Epoch:  11
Avg Train Loss/MAE = 1.3501 / 0.9076. Weights were updated.
Avg Val Loss/MAE = 2.5975 / 1.2694
Current learning rate: 0.001
Epoch:  12
Avg Train Loss/MAE = 1.2455 / 0.8790. Weights were updated.
Avg Val Loss/MAE = 2.1867 / 1.1254
Current learning rate: 0.001
Epoch:  13
Avg Train Loss/MAE = 1.2691 / 0.8896. Weights were updated.
Avg Val Loss/MAE = 2.2826 / 1.1443
Current learning rate: 0.001
Epoch:  14
Avg Train Loss/MAE = 1.1684 / 0.8455. Weights were updated.
Avg Val Loss/MAE = 1.9731 / 1.0957
Current learning rate: 0.0001
Epoch:  15
Avg Train Loss/MAE = 1.0382 / 0.8034. Weights were updated.
Avg Val Loss/MAE = 1.9803 / 1.0841
Current learning rate: 0.0001
Epoch:  16
Avg Train Loss/MAE = 0.9467 / 0.7650. Weights were updated.
Avg Val Loss/MAE = 1.9756 / 1.0814
Current learning rate: 0.0001
Epoch:  17
Avg Train Loss/MAE = 0.9303 / 0.7543. Weights were updated.
Avg Val Loss/MAE = 1.9844 / 1.0838
Current learning rate: 0.0001
Epoch:  18
Avg Train Loss/MAE = 0.9066 / 0.7481. Weights were updated.
Avg Val Loss/MAE = 2.0169 / 1.0963
Current learning rate: 0.0001
Epoch:  19
Avg Train Loss/MAE = 0.8895 / 0.7435. Weights were updated.
Avg Val Loss/MAE = 1.9545 / 1.0779
Current learning rate: 0.0001
Epoch:  20
Avg Train Loss/MAE = 0.8775 / 0.7352. Weights were updated.
Avg Val Loss/MAE = 1.9841 / 1.0845
Current learning rate: 0.0001
Epoch:  21
Avg Train Loss/MAE = 0.8376 / 0.7207. Weights were updated.
Avg Val Loss/MAE = 2.0118 / 1.0865
Current learning rate: 0.0001
Epoch:  22
Avg Train Loss/MAE = 0.8613 / 0.7277. Weights were updated.
Avg Val Loss/MAE = 1.9852 / 1.0842
Current learning rate: 0.0001
Epoch:  23
Avg Train Loss/MAE = 0.8386 / 0.7184. Weights were updated.
Avg Val Loss/MAE = 2.0235 / 1.0908
Current learning rate: 0.0001
Epoch:  24
Avg Train Loss/MAE = 0.8200 / 0.7162. Weights were updated.
Avg Val Loss/MAE = 1.9872 / 1.0831
Current learning rate: 0.0001
Loss plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_final_run/fold_0/loss_plot.png
MAE plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_final_run/fold_0/mae_plot.png
Fold: 1
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Warning: No matching T1w image found for sub-OAS30042 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Loaded 1619 image pairs.
Loaded 1619 rows of metadata.
Loaded 1619 targets.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Loaded 420 image pairs.
Loaded 420 rows of metadata.
Loaded 420 targets.
Epoch:  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Avg Train Loss/MAE = 6.5131 / 1.9360. Weights were updated.
Avg Val Loss/MAE = 5.9636 / 1.9393
Current learning rate: 0.001
Epoch:  1
Avg Train Loss/MAE = 3.2313 / 1.3967. Weights were updated.
Avg Val Loss/MAE = 5.2506 / 1.7887
Current learning rate: 0.001
Epoch:  2
Avg Train Loss/MAE = 2.6549 / 1.2452. Weights were updated.
Avg Val Loss/MAE = 5.0792 / 1.7601
Current learning rate: 0.001
Epoch:  3
Avg Train Loss/MAE = 2.2575 / 1.1536. Weights were updated.
Avg Val Loss/MAE = 4.8757 / 1.7475
Current learning rate: 0.001
Epoch:  4
Avg Train Loss/MAE = 2.2040 / 1.1353. Weights were updated.
Avg Val Loss/MAE = 4.7779 / 1.7447
Current learning rate: 0.001
Epoch:  5
Avg Train Loss/MAE = 2.0081 / 1.1028. Weights were updated.
Avg Val Loss/MAE = 3.3557 / 1.4184
Current learning rate: 0.001
Epoch:  6
Avg Train Loss/MAE = 1.9804 / 1.0905. Weights were updated.
Avg Val Loss/MAE = 3.7330 / 1.5071
Current learning rate: 0.001
Epoch:  7
Avg Train Loss/MAE = 1.7194 / 1.0191. Weights were updated.
Avg Val Loss/MAE = 3.1013 / 1.3633
Current learning rate: 0.001
Epoch:  8
Avg Train Loss/MAE = 1.5226 / 0.9586. Weights were updated.
Avg Val Loss/MAE = 3.3498 / 1.4277
Current learning rate: 0.001
Epoch:  9
Avg Train Loss/MAE = 1.4423 / 0.9340. Weights were updated.
Avg Val Loss/MAE = 3.0021 / 1.3610
Current learning rate: 0.001
Epoch:  10
Avg Train Loss/MAE = 1.5137 / 0.9535. Weights were updated.
Avg Val Loss/MAE = 3.3528 / 1.4376
Current learning rate: 0.001
Epoch:  11
Avg Train Loss/MAE = 1.3127 / 0.8860. Weights were updated.
Avg Val Loss/MAE = 2.8219 / 1.3101
Current learning rate: 0.001
Epoch:  12
Avg Train Loss/MAE = 1.2691 / 0.8754. Weights were updated.
Avg Val Loss/MAE = 2.6224 / 1.2547
Current learning rate: 0.001
Epoch:  13
Avg Train Loss/MAE = 1.1640 / 0.8382. Weights were updated.
Avg Val Loss/MAE = 2.7424 / 1.2733
Current learning rate: 0.001
Epoch:  14
Avg Train Loss/MAE = 1.1103 / 0.8263. Weights were updated.
Avg Val Loss/MAE = 2.4266 / 1.1966
Current learning rate: 0.0001
Epoch:  15
Avg Train Loss/MAE = 0.9542 / 0.7531. Weights were updated.
Avg Val Loss/MAE = 2.4736 / 1.2118
Current learning rate: 0.0001
Epoch:  16
Avg Train Loss/MAE = 0.9015 / 0.7325. Weights were updated.
Avg Val Loss/MAE = 2.3475 / 1.1807
Current learning rate: 0.0001
Epoch:  17
Avg Train Loss/MAE = 0.8501 / 0.7123. Weights were updated.
Avg Val Loss/MAE = 2.4023 / 1.1958
Current learning rate: 0.0001
Epoch:  18
Avg Train Loss/MAE = 0.8354 / 0.7068. Weights were updated.
Avg Val Loss/MAE = 2.3170 / 1.1730
Current learning rate: 0.0001
Epoch:  19
Avg Train Loss/MAE = 0.8299 / 0.7057. Weights were updated.
Avg Val Loss/MAE = 2.3222 / 1.1760
Current learning rate: 0.0001
Epoch:  20
Avg Train Loss/MAE = 0.8178 / 0.7003. Weights were updated.
Avg Val Loss/MAE = 2.3578 / 1.1869
Current learning rate: 0.0001
Epoch:  21
Avg Train Loss/MAE = 0.8197 / 0.6965. Weights were updated.
Avg Val Loss/MAE = 2.3304 / 1.1782
Current learning rate: 0.0001
Epoch:  22
Avg Train Loss/MAE = 0.8066 / 0.6966. Weights were updated.
Avg Val Loss/MAE = 2.2921 / 1.1712
Current learning rate: 0.0001
Epoch:  23
Avg Train Loss/MAE = 0.7633 / 0.6782. Weights were updated.
Avg Val Loss/MAE = 2.3294 / 1.1754
Current learning rate: 0.0001
Epoch:  24
Avg Train Loss/MAE = 0.7416 / 0.6660. Weights were updated.
Avg Val Loss/MAE = 2.2746 / 1.1608
Current learning rate: 0.0001
Loss plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_final_run/fold_1/loss_plot.png
MAE plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_final_run/fold_1/mae_plot.png
Fold: 2
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Warning: No matching T1w image found for sub-OAS30042 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Loaded 1636 image pairs.
Loaded 1636 rows of metadata.
Loaded 1636 targets.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Loaded 403 image pairs.
Loaded 403 rows of metadata.
Loaded 403 targets.
Epoch:  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Avg Train Loss/MAE = 6.3270 / 1.9137. Weights were updated.
Avg Val Loss/MAE = 3.7585 / 1.5061
Current learning rate: 0.001
Epoch:  1
Avg Train Loss/MAE = 3.4097 / 1.4401. Weights were updated.
Avg Val Loss/MAE = 8.2810 / 2.3807
Current learning rate: 0.001
Epoch:  2
Avg Train Loss/MAE = 2.6889 / 1.2619. Weights were updated.
Avg Val Loss/MAE = 3.1853 / 1.3856
Current learning rate: 0.001
Epoch:  3
Avg Train Loss/MAE = 2.2891 / 1.1613. Weights were updated.
Avg Val Loss/MAE = 3.8350 / 1.5607
Current learning rate: 0.001
Epoch:  4
Avg Train Loss/MAE = 1.8942 / 1.0630. Weights were updated.
Avg Val Loss/MAE = 2.8201 / 1.3185
Current learning rate: 0.001
Epoch:  5
Avg Train Loss/MAE = 1.6160 / 0.9931. Weights were updated.
Avg Val Loss/MAE = 2.3241 / 1.1877
Current learning rate: 0.001
Epoch:  6
Avg Train Loss/MAE = 1.5822 / 0.9760. Weights were updated.
Avg Val Loss/MAE = 2.4513 / 1.2225
Current learning rate: 0.001
Epoch:  7
Avg Train Loss/MAE = 1.5008 / 0.9388. Weights were updated.
Avg Val Loss/MAE = 2.4763 / 1.2261
Current learning rate: 0.001
Epoch:  8
Avg Train Loss/MAE = 1.3293 / 0.8926. Weights were updated.
Avg Val Loss/MAE = 2.1441 / 1.1226
Current learning rate: 0.001
Epoch:  9
Avg Train Loss/MAE = 1.3040 / 0.8851. Weights were updated.
Avg Val Loss/MAE = 2.3611 / 1.1593
Current learning rate: 0.001
Epoch:  10
Avg Train Loss/MAE = 1.1975 / 0.8488. Weights were updated.
Avg Val Loss/MAE = 1.8858 / 1.0634
Current learning rate: 0.001
Epoch:  11
Avg Train Loss/MAE = 0.9652 / 0.7570. Weights were updated.
Avg Val Loss/MAE = 2.5344 / 1.2468
Current learning rate: 0.001
Epoch:  12
Avg Train Loss/MAE = 0.9327 / 0.7414. Weights were updated.
Avg Val Loss/MAE = 2.2658 / 1.1494
Current learning rate: 0.001
Epoch:  13
Avg Train Loss/MAE = 0.8310 / 0.7010. Weights were updated.
Avg Val Loss/MAE = 1.6615 / 0.9839
Current learning rate: 0.001
Epoch:  14
Avg Train Loss/MAE = 0.7834 / 0.6836. Weights were updated.
Avg Val Loss/MAE = 1.9422 / 1.0694
Current learning rate: 0.0001
Epoch:  15
Avg Train Loss/MAE = 0.6171 / 0.5969. Weights were updated.
Avg Val Loss/MAE = 1.8211 / 1.0234
Current learning rate: 0.0001
Epoch:  16
Avg Train Loss/MAE = 0.5450 / 0.5600. Weights were updated.
Avg Val Loss/MAE = 1.7612 / 1.0056
Current learning rate: 0.0001
Epoch:  17
Avg Train Loss/MAE = 0.5104 / 0.5411. Weights were updated.
Avg Val Loss/MAE = 1.8477 / 1.0269
Current learning rate: 0.0001
Epoch:  18
Avg Train Loss/MAE = 0.4939 / 0.5325. Weights were updated.
Avg Val Loss/MAE = 1.8277 / 1.0195
Current learning rate: 0.0001
Epoch:  19
Avg Train Loss/MAE = 0.4834 / 0.5251. Weights were updated.
Avg Val Loss/MAE = 1.7289 / 0.9932
Current learning rate: 0.0001
Epoch:  20
Avg Train Loss/MAE = 0.4528 / 0.5158. Weights were updated.
Avg Val Loss/MAE = 1.7520 / 1.0007
Current learning rate: 0.0001
Epoch:  21
Avg Train Loss/MAE = 0.4425 / 0.5061. Weights were updated.
Avg Val Loss/MAE = 1.7518 / 0.9979
Current learning rate: 0.0001
Epoch:  22
Avg Train Loss/MAE = 0.4176 / 0.4882. Weights were updated.
Avg Val Loss/MAE = 1.7708 / 1.0059
Current learning rate: 0.0001
Epoch:  23
Avg Train Loss/MAE = 0.4091 / 0.4886. Weights were updated.
Avg Val Loss/MAE = 1.7689 / 1.0095
Current learning rate: 0.0001
Epoch:  24
Avg Train Loss/MAE = 0.3916 / 0.4747. Weights were updated.
Avg Val Loss/MAE = 1.7969 / 1.0147
Current learning rate: 0.0001
Loss plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_final_run/fold_2/loss_plot.png
MAE plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_final_run/fold_2/mae_plot.png
Fold: 3
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Loaded 1681 image pairs.
Loaded 1681 rows of metadata.
Loaded 1681 targets.
Warning: No matching T1w image found for sub-OAS30042 in session(s). Skipping.
Loaded 358 image pairs.
Loaded 358 rows of metadata.
Loaded 358 targets.
Epoch:  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Avg Train Loss/MAE = 6.6693 / 1.9483. Weights were updated.
Avg Val Loss/MAE = 7.1518 / 2.0781
Current learning rate: 0.001
Epoch:  1
Avg Train Loss/MAE = 4.5104 / 1.6229. Weights were updated.
Avg Val Loss/MAE = 4.3207 / 1.5728
Current learning rate: 0.001
Epoch:  2
Avg Train Loss/MAE = 2.8193 / 1.2964. Weights were updated.
Avg Val Loss/MAE = 4.3678 / 1.5940
Current learning rate: 0.001
Epoch:  3
Avg Train Loss/MAE = 2.3966 / 1.1986. Weights were updated.
Avg Val Loss/MAE = 6.3763 / 2.0182
Current learning rate: 0.001
Epoch:  4
Avg Train Loss/MAE = 2.5272 / 1.2204. Weights were updated.
Avg Val Loss/MAE = 4.4812 / 1.6346
Current learning rate: 0.001
Epoch:  5
Avg Train Loss/MAE = 2.2699 / 1.1743. Weights were updated.
Avg Val Loss/MAE = 3.5323 / 1.4066
Current learning rate: 0.001
Epoch:  6
Avg Train Loss/MAE = 1.9320 / 1.0816. Weights were updated.
Avg Val Loss/MAE = 3.2365 / 1.3329
Current learning rate: 0.001
Epoch:  7
Avg Train Loss/MAE = 1.6138 / 1.0039. Weights were updated.
Avg Val Loss/MAE = 3.2765 / 1.3458
Current learning rate: 0.001
Epoch:  8
Avg Train Loss/MAE = 1.5022 / 0.9461. Weights were updated.
Avg Val Loss/MAE = 3.5987 / 1.4386
Current learning rate: 0.001
Epoch:  9
Avg Train Loss/MAE = 1.4604 / 0.9381. Weights were updated.
Avg Val Loss/MAE = 3.3135 / 1.3821
Current learning rate: 0.001
Epoch:  10
Avg Train Loss/MAE = 1.4032 / 0.9175. Weights were updated.
Avg Val Loss/MAE = 3.2515 / 1.3456
Current learning rate: 0.001
Epoch:  11
Avg Train Loss/MAE = 1.2708 / 0.8738. Weights were updated.
Avg Val Loss/MAE = 2.9257 / 1.2988
Current learning rate: 0.001
Epoch:  12
Avg Train Loss/MAE = 1.2022 / 0.8475. Weights were updated.
Avg Val Loss/MAE = 3.2371 / 1.3552
Current learning rate: 0.001
Epoch:  13
Avg Train Loss/MAE = 1.1932 / 0.8406. Weights were updated.
Avg Val Loss/MAE = 2.7309 / 1.2289
Current learning rate: 0.001
Epoch:  14
Avg Train Loss/MAE = 1.0562 / 0.7882. Weights were updated.
Avg Val Loss/MAE = 3.2889 / 1.3941
Current learning rate: 0.0001
Epoch:  15
Avg Train Loss/MAE = 0.9296 / 0.7495. Weights were updated.
Avg Val Loss/MAE = 2.7636 / 1.2486
Current learning rate: 0.0001
Epoch:  16
Avg Train Loss/MAE = 0.9995 / 0.7442. Weights were updated.
Avg Val Loss/MAE = 2.7376 / 1.2415
Current learning rate: 0.0001
Epoch:  17
Avg Train Loss/MAE = 0.9412 / 0.7449. Weights were updated.
Avg Val Loss/MAE = 2.6068 / 1.2129
Current learning rate: 0.0001
Epoch:  18
Avg Train Loss/MAE = 0.8446 / 0.7078. Weights were updated.
Avg Val Loss/MAE = 2.5689 / 1.2040
Current learning rate: 0.0001
Epoch:  19
Avg Train Loss/MAE = 0.8417 / 0.7028. Weights were updated.
Avg Val Loss/MAE = 2.6140 / 1.2155
Current learning rate: 0.0001
Epoch:  20
Avg Train Loss/MAE = 0.8876 / 0.7154. Weights were updated.
Avg Val Loss/MAE = 2.6545 / 1.2300
Current learning rate: 0.0001
Epoch:  21
Avg Train Loss/MAE = 0.8206 / 0.6966. Weights were updated.
Avg Val Loss/MAE = 2.6563 / 1.2298
Current learning rate: 0.0001
Epoch:  22
Avg Train Loss/MAE = 0.7960 / 0.6889. Weights were updated.
Avg Val Loss/MAE = 2.6633 / 1.2276
Current learning rate: 0.0001
Epoch:  23
Avg Train Loss/MAE = 0.7771 / 0.6800. Weights were updated.
Avg Val Loss/MAE = 2.6549 / 1.2309
Current learning rate: 0.0001
Epoch:  24
Avg Train Loss/MAE = 0.7684 / 0.6724. Weights were updated.
Avg Val Loss/MAE = 2.5922 / 1.2128
Current learning rate: 0.0001
Loss plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_final_run/fold_3/loss_plot.png
MAE plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_final_run/fold_3/mae_plot.png
Fold: 4
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Warning: No matching T1w image found for sub-OAS30042 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Loaded 1632 image pairs.
Loaded 1632 rows of metadata.
Loaded 1632 targets.
Loaded 407 image pairs.
Loaded 407 rows of metadata.
Loaded 407 targets.
Epoch:  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Avg Train Loss/MAE = 6.1649 / 1.8744. Weights were updated.
Avg Val Loss/MAE = 6.0442 / 1.9209
Current learning rate: 0.001
Epoch:  1
Avg Train Loss/MAE = 3.2126 / 1.3939. Weights were updated.
Avg Val Loss/MAE = 6.0362 / 1.9810
Current learning rate: 0.001
Epoch:  2
Avg Train Loss/MAE = 2.8308 / 1.3078. Weights were updated.
Avg Val Loss/MAE = 4.8096 / 1.7074
Current learning rate: 0.001
Epoch:  3
Avg Train Loss/MAE = 2.6371 / 1.2605. Weights were updated.
Avg Val Loss/MAE = 4.3025 / 1.6327
Current learning rate: 0.001
Epoch:  4
Avg Train Loss/MAE = 2.1688 / 1.1385. Weights were updated.
Avg Val Loss/MAE = 4.4127 / 1.6775
Current learning rate: 0.001
Epoch:  5
Avg Train Loss/MAE = 2.0925 / 1.1287. Weights were updated.
Avg Val Loss/MAE = 4.6319 / 1.7278
Current learning rate: 0.001
Epoch:  6
Avg Train Loss/MAE = 1.9346 / 1.0673. Weights were updated.
Avg Val Loss/MAE = 4.2814 / 1.6627
Current learning rate: 0.001
Epoch:  7
Avg Train Loss/MAE = 1.7387 / 1.0215. Weights were updated.
Avg Val Loss/MAE = 3.5771 / 1.5030
Current learning rate: 0.001
Epoch:  8
Avg Train Loss/MAE = 1.6898 / 1.0147. Weights were updated.
Avg Val Loss/MAE = 4.1501 / 1.6443
Current learning rate: 0.001
Epoch:  9
Avg Train Loss/MAE = 1.5645 / 0.9773. Weights were updated.
Avg Val Loss/MAE = 3.1391 / 1.4198
Current learning rate: 0.001
Epoch:  10
Avg Train Loss/MAE = 1.5723 / 0.9816. Weights were updated.
Avg Val Loss/MAE = 3.1941 / 1.4405
Current learning rate: 0.001
Epoch:  11
Avg Train Loss/MAE = 1.3980 / 0.9268. Weights were updated.
Avg Val Loss/MAE = 3.2414 / 1.4212
Current learning rate: 0.001
Epoch:  12
Avg Train Loss/MAE = 1.2795 / 0.8872. Weights were updated.
Avg Val Loss/MAE = 3.1074 / 1.3957
Current learning rate: 0.001
Epoch:  13
Avg Train Loss/MAE = 1.2564 / 0.8844. Weights were updated.
Avg Val Loss/MAE = 2.8845 / 1.3452
Current learning rate: 0.001
Epoch:  14
Avg Train Loss/MAE = 1.1632 / 0.8445. Weights were updated.
Avg Val Loss/MAE = 3.2761 / 1.4433
Current learning rate: 0.0001
Epoch:  15
Avg Train Loss/MAE = 1.0112 / 0.7944. Weights were updated.
Avg Val Loss/MAE = 2.9253 / 1.3497
Current learning rate: 0.0001
Epoch:  16
Avg Train Loss/MAE = 0.9513 / 0.7665. Weights were updated.
Avg Val Loss/MAE = 2.9037 / 1.3272
Current learning rate: 0.0001
Epoch:  17
Avg Train Loss/MAE = 0.9260 / 0.7586. Weights were updated.
Avg Val Loss/MAE = 2.7843 / 1.3222
Current learning rate: 0.0001
Epoch:  18
Avg Train Loss/MAE = 0.9028 / 0.7427. Weights were updated.
Avg Val Loss/MAE = 2.8557 / 1.3423
Current learning rate: 0.0001
Epoch:  19
Avg Train Loss/MAE = 0.8785 / 0.7386. Weights were updated.
Avg Val Loss/MAE = 2.7945 / 1.3097
Current learning rate: 0.0001
Epoch:  20
Avg Train Loss/MAE = 0.8874 / 0.7376. Weights were updated.
Avg Val Loss/MAE = 2.8512 / 1.3153
Current learning rate: 0.0001
Epoch:  21
Avg Train Loss/MAE = 0.8716 / 0.7326. Weights were updated.
Avg Val Loss/MAE = 2.8126 / 1.3120
Current learning rate: 0.0001
Epoch:  22
Avg Train Loss/MAE = 0.8542 / 0.7268. Weights were updated.
Avg Val Loss/MAE = 2.8555 / 1.3322
Current learning rate: 0.0001
Epoch:  23
Avg Train Loss/MAE = 0.8451 / 0.7186. Weights were updated.
Avg Val Loss/MAE = 2.8417 / 1.3293
Current learning rate: 0.0001
Epoch:  24
Avg Train Loss/MAE = 0.8167 / 0.7090. Weights were updated.
Avg Val Loss/MAE = 2.7666 / 1.3136
Current learning rate: 0.0001
Loss plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_final_run/fold_4/loss_plot.png
MAE plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_final_run/fold_4/mae_plot.png
