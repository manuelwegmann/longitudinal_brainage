This job can be monitored from: https://job.c3se.chalmers.se/alvis/4898117
Model will be trained for CI task.
Model will be trained for CI task.
Model will be trained for CI task.
Model will be trained for CI task.
Model will be trained for CI task.
Model will be trained for CI task.
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Warning: No matching T1w image found for sub-OAS30042 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Loaded 1932 image pairs.
Loaded 1932 rows of metadata.
Loaded 1932 targets.
Loaded 107 image pairs.
Loaded 107 rows of metadata.
Loaded 107 targets.
Epoch:  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Avg Train Loss/MAE = 6.2898 / 1.8900. Weights were updated.
Avg Val Loss/MAE = 4.6627 / 1.7250
Current learning rate: 0.001
Epoch:  1
Avg Train Loss/MAE = 3.4459 / 1.4436. Weights were updated.
Avg Val Loss/MAE = 2.3425 / 1.1724
Current learning rate: 0.001
Epoch:  2
Avg Train Loss/MAE = 2.9663 / 1.3320. Weights were updated.
Avg Val Loss/MAE = 2.1250 / 1.1043
Current learning rate: 0.001
Epoch:  3
Avg Train Loss/MAE = 2.3628 / 1.2043. Weights were updated.
Avg Val Loss/MAE = 2.1637 / 1.1285
Current learning rate: 0.001
Epoch:  4
Avg Train Loss/MAE = 2.1938 / 1.1528. Weights were updated.
Avg Val Loss/MAE = 2.0942 / 1.0836
Current learning rate: 0.001
Epoch:  5
Avg Train Loss/MAE = 2.0446 / 1.1128. Weights were updated.
Avg Val Loss/MAE = 2.1861 / 1.1342
Current learning rate: 0.001
Epoch:  6
Avg Train Loss/MAE = 1.8920 / 1.0695. Weights were updated.
Avg Val Loss/MAE = 1.6595 / 0.9594
Current learning rate: 0.001
Epoch:  7
Avg Train Loss/MAE = 1.6757 / 1.0106. Weights were updated.
Avg Val Loss/MAE = 1.8767 / 1.0308
Current learning rate: 0.001
Epoch:  8
Avg Train Loss/MAE = 1.5788 / 0.9748. Weights were updated.
Avg Val Loss/MAE = 1.9578 / 1.0383
Current learning rate: 0.001
Epoch:  9
Avg Train Loss/MAE = 1.4824 / 0.9526. Weights were updated.
Avg Val Loss/MAE = 1.6936 / 0.9769
Current learning rate: 0.001
Epoch:  10
Avg Train Loss/MAE = 1.3968 / 0.9300. Weights were updated.
Avg Val Loss/MAE = 1.8260 / 1.0069
Current learning rate: 0.001
Epoch:  11
Avg Train Loss/MAE = 1.3087 / 0.8960. Weights were updated.
Avg Val Loss/MAE = 1.5972 / 0.9715
Current learning rate: 0.001
Epoch:  12
Avg Train Loss/MAE = 1.2425 / 0.8672. Weights were updated.
Avg Val Loss/MAE = 1.6321 / 0.9826
Current learning rate: 0.001
Epoch:  13
Avg Train Loss/MAE = 1.1472 / 0.8345. Weights were updated.
Avg Val Loss/MAE = 1.8150 / 1.0302
Current learning rate: 0.001
Epoch:  14
Avg Train Loss/MAE = 1.0589 / 0.8077. Weights were updated.
Avg Val Loss/MAE = 1.4817 / 0.9234
Current learning rate: 0.0001
Epoch:  15
Avg Train Loss/MAE = 0.9172 / 0.7441. Weights were updated.
Avg Val Loss/MAE = 1.3993 / 0.9219
Current learning rate: 0.0001
Epoch:  16
Avg Train Loss/MAE = 0.8554 / 0.7200. Weights were updated.
Avg Val Loss/MAE = 1.4358 / 0.9244
Current learning rate: 0.0001
Epoch:  17
Avg Train Loss/MAE = 0.8538 / 0.7202. Weights were updated.
Avg Val Loss/MAE = 1.4033 / 0.9222
Current learning rate: 0.0001
Epoch:  18
Avg Train Loss/MAE = 0.8215 / 0.7084. Weights were updated.
Avg Val Loss/MAE = 1.4217 / 0.9201
Current learning rate: 0.0001
Epoch:  19
Avg Train Loss/MAE = 0.8122 / 0.7008. Weights were updated.
Avg Val Loss/MAE = 1.3744 / 0.9121
Current learning rate: 0.0001
Epoch:  20
Avg Train Loss/MAE = 0.7955 / 0.6944. Weights were updated.
Avg Val Loss/MAE = 1.3940 / 0.9083
Current learning rate: 0.0001
Epoch:  21
Avg Train Loss/MAE = 0.7697 / 0.6833. Weights were updated.
Avg Val Loss/MAE = 1.3639 / 0.9133
Current learning rate: 0.0001
Epoch:  22
Avg Train Loss/MAE = 0.7663 / 0.6813. Weights were updated.
Avg Val Loss/MAE = 1.3769 / 0.9069
Current learning rate: 0.0001
Epoch:  23
Avg Train Loss/MAE = 0.7592 / 0.6773. Weights were updated.
Avg Val Loss/MAE = 1.3694 / 0.9096
Current learning rate: 0.0001
Epoch:  24
Avg Train Loss/MAE = 0.7352 / 0.6663. Weights were updated.
Avg Val Loss/MAE = 1.3964 / 0.9114
Current learning rate: 0.0001
Loss plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_CI/loss_plot.png
MAE plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_CI/mae_plot.png
