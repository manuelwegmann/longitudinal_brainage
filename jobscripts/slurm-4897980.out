This job can be monitored from: https://job.c3se.chalmers.se/alvis/4897980
Filename (participants file):  /mimer/NOBACKUP/groups/brainage/thesis_brainage/folds/CI_participants.csv
We are looking at CI data.
Model saved at /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_CI/model.pt will be applied to participants at /mimer/NOBACKUP/groups/brainage/thesis_brainage/folds/CI_participants.csv.
Last block has number of input channels: 64
Last block has number of output channels: 16
The model is (classic) LILAC.
Loaded 68 image pairs.
Loaded 68 rows of metadata.
Loaded 68 targets.
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
CI Loss (MSE): 2.4504
CI MAE: 1.2254
Saved results to CSV to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/folds/predictions_CI.csv.
Saved results to CSV to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_CI/predictions_CI.csv.
Filename (participants file):  /mimer/NOBACKUP/groups/brainage/thesis_brainage/folds/CN_controlgroup.csv
We are looking at CN data.
Model saved at /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_CI/model.pt will be applied to participants at /mimer/NOBACKUP/groups/brainage/thesis_brainage/folds/CN_controlgroup.csv.
Last block has number of input channels: 64
Last block has number of output channels: 16
The model is (classic) LILAC.
Loaded 98 image pairs.
Loaded 98 rows of metadata.
Loaded 98 targets.
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
CN Loss (MSE): 0.8823
CN MAE: 0.8052
Saved results to CSV to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/folds/predictions_CN.csv.
Saved results to CSV to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_CI/predictions_CN.csv.
Filename (participants file):  /mimer/NOBACKUP/groups/brainage/thesis_brainage/folds/CI_participants.csv
We are looking at CI data.
Model saved at /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_plus_CI/model.pt will be applied to participants at /mimer/NOBACKUP/groups/brainage/thesis_brainage/folds/CI_participants.csv.
Last block has number of input channels: 64
Last block has number of output channels: 16
The model is (classic) LILAC.
Traceback (most recent call last):
  File "/mimer/NOBACKUP/groups/brainage/thesis_brainage/scripts/apply_LILAC.py", line 167, in <module>
    model.load_state_dict(checkpoint['model_state_dict'])
  File "/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 2581, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for LILAC:
	Missing key(s) in state_dict: "linear.weight". 
	Unexpected key(s) in state_dict: "linear.0.weight", "linear.0.bias", "linear.3.weight", "linear.3.bias", "linear.6.weight", "linear.6.bias", "linear.8.weight", "linear.8.bias". 
Filename (participants file):  /mimer/NOBACKUP/groups/brainage/thesis_brainage/folds/CN_controlgroup.csv
We are looking at CN data.
Model saved at /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_plus_CI/model.pt will be applied to participants at /mimer/NOBACKUP/groups/brainage/thesis_brainage/folds/CN_controlgroup.csv.
Last block has number of input channels: 64
Last block has number of output channels: 16
The model is (classic) LILAC.
Traceback (most recent call last):
  File "/mimer/NOBACKUP/groups/brainage/thesis_brainage/scripts/apply_LILAC.py", line 167, in <module>
    model.load_state_dict(checkpoint['model_state_dict'])
  File "/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 2581, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for LILAC:
	Missing key(s) in state_dict: "linear.weight". 
	Unexpected key(s) in state_dict: "linear.0.weight", "linear.0.bias", "linear.3.weight", "linear.3.bias", "linear.6.weight", "linear.6.bias", "linear.8.weight", "linear.8.bias". 
