This job can be monitored from: https://job.c3se.chalmers.se/alvis/4896514
Model will be trained for CI task.
Model will be trained for CI task.
Model will be trained for CI task.
Model will be trained for CI task.
Model will be trained for CI task.
Model will be trained for CI task.
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Warning: No matching T1w image found for sub-OAS30042 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Loaded 1941 image pairs.
Loaded 1941 rows of metadata.
Loaded 1941 targets.
Loaded 98 image pairs.
Loaded 98 rows of metadata.
Loaded 98 targets.
Epoch:  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Avg Train Loss/MAE = 5.6034 / 1.7885. Weights were updated.
Avg Val Loss/MAE = 2.9398 / 1.3485
Current learning rate: 0.001
Epoch:  1
Avg Train Loss/MAE = 3.1682 / 1.3838. Weights were updated.
Avg Val Loss/MAE = 2.4208 / 1.1660
Current learning rate: 0.001
Epoch:  2
Avg Train Loss/MAE = 2.8173 / 1.3050. Weights were updated.
Avg Val Loss/MAE = 2.4304 / 1.1569
Current learning rate: 0.001
Epoch:  3
Avg Train Loss/MAE = 2.2924 / 1.1747. Weights were updated.
Avg Val Loss/MAE = 2.0069 / 1.0362
Current learning rate: 0.001
Epoch:  4
Avg Train Loss/MAE = 2.0581 / 1.1121. Weights were updated.
Avg Val Loss/MAE = 1.7405 / 0.9474
Current learning rate: 0.001
Epoch:  5
Avg Train Loss/MAE = 1.9132 / 1.0900. Weights were updated.
Avg Val Loss/MAE = 1.9424 / 1.0408
Current learning rate: 0.001
Epoch:  6
Avg Train Loss/MAE = 1.6508 / 1.0086. Weights were updated.
Avg Val Loss/MAE = 1.8581 / 1.0035
Current learning rate: 0.001
Epoch:  7
Avg Train Loss/MAE = 1.5054 / 0.9583. Weights were updated.
Avg Val Loss/MAE = 1.5273 / 0.9076
Current learning rate: 0.001
Epoch:  8
Avg Train Loss/MAE = 1.3910 / 0.9256. Weights were updated.
Avg Val Loss/MAE = 1.3571 / 0.8745
Current learning rate: 0.001
Epoch:  9
Avg Train Loss/MAE = 1.3074 / 0.8975. Weights were updated.
Avg Val Loss/MAE = 1.5382 / 0.9307
Current learning rate: 0.001
Epoch:  10
Avg Train Loss/MAE = 1.2476 / 0.8708. Weights were updated.
Avg Val Loss/MAE = 1.5937 / 0.9286
Current learning rate: 0.001
Epoch:  11
Avg Train Loss/MAE = 1.2049 / 0.8593. Weights were updated.
Avg Val Loss/MAE = 1.2876 / 0.8622
Current learning rate: 0.001
Epoch:  12
Avg Train Loss/MAE = 1.1311 / 0.8274. Weights were updated.
Avg Val Loss/MAE = 1.2357 / 0.8752
Current learning rate: 0.001
Epoch:  13
Avg Train Loss/MAE = 0.9650 / 0.7654. Weights were updated.
Avg Val Loss/MAE = 1.2149 / 0.9164
Current learning rate: 0.001
Epoch:  14
Avg Train Loss/MAE = 0.9428 / 0.7551. Weights were updated.
Avg Val Loss/MAE = 1.0801 / 0.8622
Current learning rate: 0.0001
Epoch:  15
Avg Train Loss/MAE = 0.7979 / 0.6968. Weights were updated.
Avg Val Loss/MAE = 1.0053 / 0.8200
Current learning rate: 0.0001
Epoch:  16
Avg Train Loss/MAE = 0.7093 / 0.6568. Weights were updated.
Avg Val Loss/MAE = 0.9832 / 0.7766
Current learning rate: 0.0001
Epoch:  17
Avg Train Loss/MAE = 0.6808 / 0.6414. Weights were updated.
Avg Val Loss/MAE = 1.0014 / 0.7879
Current learning rate: 0.0001
Epoch:  18
Avg Train Loss/MAE = 0.6684 / 0.6356. Weights were updated.
Avg Val Loss/MAE = 0.9380 / 0.7774
Current learning rate: 0.0001
Epoch:  19
Avg Train Loss/MAE = 0.6480 / 0.6262. Weights were updated.
Avg Val Loss/MAE = 0.9168 / 0.7635
Current learning rate: 0.0001
Epoch:  20
Avg Train Loss/MAE = 0.6341 / 0.6175. Weights were updated.
Avg Val Loss/MAE = 0.9186 / 0.7628
Current learning rate: 0.0001
Epoch:  21
Avg Train Loss/MAE = 0.6190 / 0.6148. Weights were updated.
Avg Val Loss/MAE = 0.9384 / 0.7629
Current learning rate: 0.0001
Epoch:  22
Avg Train Loss/MAE = 0.5894 / 0.5964. Weights were updated.
Avg Val Loss/MAE = 0.9120 / 0.7532
Current learning rate: 0.0001
Epoch:  23
Avg Train Loss/MAE = 0.5666 / 0.5834. Weights were updated.
Avg Val Loss/MAE = 0.8985 / 0.7590
Current learning rate: 0.0001
Epoch:  24
Avg Train Loss/MAE = 0.5611 / 0.5789. Weights were updated.
Avg Val Loss/MAE = 0.8823 / 0.7682
Current learning rate: 0.0001
Loss plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_CI/loss_plot.png
MAE plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_CI/mae_plot.png
