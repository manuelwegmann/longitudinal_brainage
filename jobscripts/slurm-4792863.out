This job can be monitored from: https://job.c3se.chalmers.se/alvis/4792863
Fold: 0
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Warning: No matching T1w image found for sub-OAS30042 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Loaded 1588 image pairs.
Loaded 1588 rows of metadata.
Loaded 1588 targets.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Loaded 451 image pairs.
Loaded 451 rows of metadata.
Loaded 451 targets.
Epoch:  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Avg Train Loss/MAE = 4.1496 / 1.5235. Weights were updated.
Avg Val Loss/MAE = 3.7336 / 1.4812
Current learning rate: 0.001
Epoch:  1
Avg Train Loss/MAE = 2.1612 / 1.1451. Weights were updated.
Avg Val Loss/MAE = 3.4800 / 1.4413
Current learning rate: 0.001
Epoch:  2
Avg Train Loss/MAE = 2.0870 / 1.1074. Weights were updated.
Avg Val Loss/MAE = 1.9949 / 1.1154
Current learning rate: 0.001
Epoch:  3
Avg Train Loss/MAE = 1.6922 / 1.0063. Weights were updated.
Avg Val Loss/MAE = 1.8457 / 1.0571
Current learning rate: 0.001
Epoch:  4
Avg Train Loss/MAE = 1.8715 / 1.0521. Weights were updated.
Avg Val Loss/MAE = 2.0303 / 1.1063
Current learning rate: 0.001
Epoch:  5
Avg Train Loss/MAE = 1.1891 / 0.8360. Weights were updated.
Avg Val Loss/MAE = 1.7516 / 1.0146
Current learning rate: 0.001
Epoch:  6
Avg Train Loss/MAE = 0.9705 / 0.7758. Weights were updated.
Avg Val Loss/MAE = 3.0104 / 1.3588
Current learning rate: 0.001
Epoch:  7
Avg Train Loss/MAE = 1.0887 / 0.7888. Weights were updated.
Avg Val Loss/MAE = 2.5121 / 1.2345
Current learning rate: 0.001
Epoch:  8
Avg Train Loss/MAE = 0.8228 / 0.7056. Weights were updated.
Avg Val Loss/MAE = 1.8773 / 1.0363
Current learning rate: 0.001
Epoch:  9
Avg Train Loss/MAE = 0.7601 / 0.6664. Weights were updated.
Avg Val Loss/MAE = 1.7235 / 0.9883
Current learning rate: 0.001
Epoch:  10
Avg Train Loss/MAE = 0.7064 / 0.6240. Weights were updated.
Avg Val Loss/MAE = 2.2303 / 1.1512
Current learning rate: 0.001
Epoch:  11
Avg Train Loss/MAE = 0.6682 / 0.6301. Weights were updated.
Avg Val Loss/MAE = 2.4333 / 1.1851
Current learning rate: 0.001
Epoch:  12
Avg Train Loss/MAE = 0.5697 / 0.5760. Weights were updated.
Avg Val Loss/MAE = 1.7574 / 1.0014
Current learning rate: 0.001
Epoch:  13
Avg Train Loss/MAE = 0.5294 / 0.5520. Weights were updated.
Avg Val Loss/MAE = 1.7977 / 1.0259
Current learning rate: 0.001
Epoch:  14
Avg Train Loss/MAE = 0.6295 / 0.5769. Weights were updated.
Avg Val Loss/MAE = 2.0186 / 1.0833
Current learning rate: 0.001
Epoch:  15
Avg Train Loss/MAE = 0.4481 / 0.4960. Weights were updated.
Avg Val Loss/MAE = 3.2374 / 1.3738
Current learning rate: 0.001
Epoch:  16
Avg Train Loss/MAE = 0.5986 / 0.5476. Weights were updated.
Avg Val Loss/MAE = 1.5755 / 0.9505
Current learning rate: 0.001
Epoch:  17
Avg Train Loss/MAE = 0.3758 / 0.4591. Weights were updated.
Avg Val Loss/MAE = 1.9788 / 1.0919
Current learning rate: 0.001
Epoch:  18
Avg Train Loss/MAE = 0.4036 / 0.4660. Weights were updated.
Avg Val Loss/MAE = 1.9243 / 1.0602
Current learning rate: 0.001
Epoch:  19
Avg Train Loss/MAE = 0.3924 / 0.4580. Weights were updated.
Avg Val Loss/MAE = 1.7804 / 1.0304
Current learning rate: 0.001
Epoch:  20
Avg Train Loss/MAE = 0.3390 / 0.4269. Weights were updated.
Avg Val Loss/MAE = 1.6974 / 0.9944
Current learning rate: 0.001
Epoch:  21
Avg Train Loss/MAE = 0.3751 / 0.4543. Weights were updated.
Avg Val Loss/MAE = 1.5626 / 0.9430
Current learning rate: 0.001
Epoch:  22
Avg Train Loss/MAE = 0.2629 / 0.3851. Weights were updated.
Avg Val Loss/MAE = 1.8995 / 1.0454
Current learning rate: 0.001
Epoch:  23
Avg Train Loss/MAE = 0.2815 / 0.3957. Weights were updated.
Avg Val Loss/MAE = 1.6153 / 0.9662
Current learning rate: 0.001
Epoch:  24
Avg Train Loss/MAE = 0.2878 / 0.3904. Weights were updated.
Avg Val Loss/MAE = 1.5113 / 0.9361
Current learning rate: 0.0001
Epoch:  25
Avg Train Loss/MAE = 0.2051 / 0.3291. Weights were updated.
Avg Val Loss/MAE = 1.5953 / 0.9569
Current learning rate: 0.0001
Epoch:  26
Avg Train Loss/MAE = 0.1404 / 0.2794. Weights were updated.
Avg Val Loss/MAE = 1.6190 / 0.9669
Current learning rate: 0.0001
Epoch:  27
Avg Train Loss/MAE = 0.1351 / 0.2708. Weights were updated.
Avg Val Loss/MAE = 1.5936 / 0.9584
Current learning rate: 0.0001
Epoch:  28
Avg Train Loss/MAE = 0.1134 / 0.2482. Weights were updated.
Avg Val Loss/MAE = 1.6419 / 0.9728
Current learning rate: 0.0001
Epoch:  29
Avg Train Loss/MAE = 0.1044 / 0.2411. Weights were updated.
Avg Val Loss/MAE = 1.6047 / 0.9592
Current learning rate: 0.0001
Epoch:  30
Avg Train Loss/MAE = 0.1108 / 0.2446. Weights were updated.
Avg Val Loss/MAE = 1.6016 / 0.9589
Current learning rate: 0.0001
Epoch:  31
Avg Train Loss/MAE = 0.1011 / 0.2328. Weights were updated.
Avg Val Loss/MAE = 1.6140 / 0.9604
Current learning rate: 0.0001
Epoch:  32
Avg Train Loss/MAE = 0.1077 / 0.2446. Weights were updated.
Avg Val Loss/MAE = 1.6038 / 0.9589
Current learning rate: 0.0001
Epoch:  33
Avg Train Loss/MAE = 0.1120 / 0.2439. Weights were updated.
Avg Val Loss/MAE = 1.6378 / 0.9705
Current learning rate: 0.0001
Epoch:  34
Avg Train Loss/MAE = 0.0970 / 0.2308. Weights were updated.
Avg Val Loss/MAE = 1.5795 / 0.9533
Current learning rate: 0.0001
Loss plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_plus_final_run/fold_0/loss_plot.png
MAE plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_plus_final_run/fold_0/mae_plot.png
Fold: 1
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Warning: No matching T1w image found for sub-OAS30042 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Loaded 1619 image pairs.
Loaded 1619 rows of metadata.
Loaded 1619 targets.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Loaded 420 image pairs.
Loaded 420 rows of metadata.
Loaded 420 targets.
Epoch:  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Avg Train Loss/MAE = 4.0155 / 1.5145. Weights were updated.
Avg Val Loss/MAE = 2.9258 / 1.2994
Current learning rate: 0.001
Epoch:  1
Avg Train Loss/MAE = 2.0727 / 1.1066. Weights were updated.
Avg Val Loss/MAE = 2.2628 / 1.1744
Current learning rate: 0.001
Epoch:  2
Avg Train Loss/MAE = 1.8205 / 1.0431. Weights were updated.
Avg Val Loss/MAE = 2.6459 / 1.2569
Current learning rate: 0.001
Epoch:  3
Avg Train Loss/MAE = 1.5168 / 0.9630. Weights were updated.
Avg Val Loss/MAE = 1.6882 / 1.0003
Current learning rate: 0.001
Epoch:  4
Avg Train Loss/MAE = 1.2858 / 0.8793. Weights were updated.
Avg Val Loss/MAE = 1.8018 / 1.0006
Current learning rate: 0.001
Epoch:  5
Avg Train Loss/MAE = 1.2396 / 0.8657. Weights were updated.
Avg Val Loss/MAE = 1.9131 / 1.0304
Current learning rate: 0.001
Epoch:  6
Avg Train Loss/MAE = 1.0793 / 0.7907. Weights were updated.
Avg Val Loss/MAE = 1.6415 / 0.9602
Current learning rate: 0.001
Epoch:  7
Avg Train Loss/MAE = 0.8847 / 0.7113. Weights were updated.
Avg Val Loss/MAE = 1.5982 / 0.9646
Current learning rate: 0.001
Epoch:  8
Avg Train Loss/MAE = 0.8856 / 0.6982. Weights were updated.
Avg Val Loss/MAE = 1.6152 / 0.9893
Current learning rate: 0.001
Epoch:  9
Avg Train Loss/MAE = 0.8811 / 0.6900. Weights were updated.
Avg Val Loss/MAE = 2.4325 / 1.1928
Current learning rate: 0.001
Epoch:  10
Avg Train Loss/MAE = 0.8021 / 0.6801. Weights were updated.
Avg Val Loss/MAE = 1.6317 / 0.9969
Current learning rate: 0.001
Epoch:  11
Avg Train Loss/MAE = 0.6956 / 0.6364. Weights were updated.
Avg Val Loss/MAE = 1.7718 / 1.0230
Current learning rate: 0.001
Epoch:  12
Avg Train Loss/MAE = 0.5291 / 0.5581. Weights were updated.
Avg Val Loss/MAE = 1.7021 / 1.0130
Current learning rate: 0.001
Epoch:  13
Avg Train Loss/MAE = 0.4595 / 0.5139. Weights were updated.
Avg Val Loss/MAE = 1.4825 / 0.9451
Current learning rate: 0.001
Epoch:  14
Avg Train Loss/MAE = 0.4626 / 0.5013. Weights were updated.
Avg Val Loss/MAE = 1.5932 / 0.9706
Current learning rate: 0.001
Epoch:  15
Avg Train Loss/MAE = 0.3904 / 0.4705. Weights were updated.
Avg Val Loss/MAE = 1.6741 / 0.9717
Current learning rate: 0.001
Epoch:  16
Avg Train Loss/MAE = 0.4216 / 0.4910. Weights were updated.
Avg Val Loss/MAE = 1.6458 / 1.0050
Current learning rate: 0.001
Epoch:  17
Avg Train Loss/MAE = 0.3965 / 0.4730. Weights were updated.
Avg Val Loss/MAE = 1.5638 / 0.9669
Current learning rate: 0.001
Epoch:  18
Avg Train Loss/MAE = 0.3914 / 0.4630. Weights were updated.
Avg Val Loss/MAE = 1.6083 / 0.9754
Current learning rate: 0.001
Epoch:  19
Avg Train Loss/MAE = 0.2971 / 0.4082. Weights were updated.
Avg Val Loss/MAE = 1.6656 / 0.9888
Current learning rate: 0.001
Epoch:  20
Avg Train Loss/MAE = 0.3053 / 0.4112. Weights were updated.
Avg Val Loss/MAE = 1.5121 / 0.9515
Current learning rate: 0.001
Epoch:  21
Avg Train Loss/MAE = 0.2835 / 0.3975. Weights were updated.
Avg Val Loss/MAE = 1.7420 / 0.9913
Current learning rate: 0.001
Epoch:  22
Avg Train Loss/MAE = 0.3508 / 0.4440. Weights were updated.
Avg Val Loss/MAE = 1.4837 / 0.9375
Current learning rate: 0.001
Epoch:  23
Avg Train Loss/MAE = 0.4908 / 0.5271. Weights were updated.
Avg Val Loss/MAE = 2.4681 / 1.1617
Current learning rate: 0.001
Epoch:  24
Avg Train Loss/MAE = 0.3451 / 0.4371. Weights were updated.
Avg Val Loss/MAE = 1.6430 / 0.9999
Current learning rate: 0.0001
Epoch:  25
Avg Train Loss/MAE = 0.2096 / 0.3337. Weights were updated.
Avg Val Loss/MAE = 1.4921 / 0.9471
Current learning rate: 0.0001
Epoch:  26
Avg Train Loss/MAE = 0.1384 / 0.2765. Weights were updated.
Avg Val Loss/MAE = 1.4979 / 0.9430
Current learning rate: 0.0001
Epoch:  27
Avg Train Loss/MAE = 0.1460 / 0.2810. Weights were updated.
Avg Val Loss/MAE = 1.4863 / 0.9382
Current learning rate: 0.0001
Epoch:  28
Avg Train Loss/MAE = 0.1242 / 0.2667. Weights were updated.
Avg Val Loss/MAE = 1.5097 / 0.9396
Current learning rate: 0.0001
Epoch:  29
Avg Train Loss/MAE = 0.1272 / 0.2625. Weights were updated.
Avg Val Loss/MAE = 1.4755 / 0.9360
Current learning rate: 0.0001
Epoch:  30
Avg Train Loss/MAE = 0.1135 / 0.2530. Weights were updated.
Avg Val Loss/MAE = 1.4690 / 0.9269
Current learning rate: 0.0001
Epoch:  31
Avg Train Loss/MAE = 0.1104 / 0.2471. Weights were updated.
Avg Val Loss/MAE = 1.4680 / 0.9285
Current learning rate: 0.0001
Epoch:  32
Avg Train Loss/MAE = 0.1172 / 0.2485. Weights were updated.
Avg Val Loss/MAE = 1.5059 / 0.9349
Current learning rate: 0.0001
Epoch:  33
Avg Train Loss/MAE = 0.1024 / 0.2376. Weights were updated.
Avg Val Loss/MAE = 1.5003 / 0.9382
Current learning rate: 0.0001
Epoch:  34
Avg Train Loss/MAE = 0.1044 / 0.2412. Weights were updated.
Avg Val Loss/MAE = 1.4844 / 0.9315
Current learning rate: 0.0001
Loss plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_plus_final_run/fold_1/loss_plot.png
MAE plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_plus_final_run/fold_1/mae_plot.png
Fold: 2
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Warning: No matching T1w image found for sub-OAS30042 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Loaded 1636 image pairs.
Loaded 1636 rows of metadata.
Loaded 1636 targets.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Loaded 403 image pairs.
Loaded 403 rows of metadata.
Loaded 403 targets.
Epoch:  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Avg Train Loss/MAE = 3.7539 / 1.4464. Weights were updated.
Avg Val Loss/MAE = 2.5902 / 1.2482
Current learning rate: 0.001
Epoch:  1
Avg Train Loss/MAE = 2.1457 / 1.1315. Weights were updated.
Avg Val Loss/MAE = 2.2119 / 1.1620
Current learning rate: 0.001
Epoch:  2
Avg Train Loss/MAE = 1.7596 / 1.0307. Weights were updated.
Avg Val Loss/MAE = 2.6748 / 1.2691
Current learning rate: 0.001
Epoch:  3
Avg Train Loss/MAE = 1.6180 / 0.9814. Weights were updated.
Avg Val Loss/MAE = 2.0131 / 1.0747
Current learning rate: 0.001
Epoch:  4
Avg Train Loss/MAE = 1.2539 / 0.8726. Weights were updated.
Avg Val Loss/MAE = 1.8744 / 1.0437
Current learning rate: 0.001
Epoch:  5
Avg Train Loss/MAE = 1.3772 / 0.8968. Weights were updated.
Avg Val Loss/MAE = 2.2210 / 1.1280
Current learning rate: 0.001
Epoch:  6
Avg Train Loss/MAE = 1.0801 / 0.8027. Weights were updated.
Avg Val Loss/MAE = 2.0014 / 1.0775
Current learning rate: 0.001
Epoch:  7
Avg Train Loss/MAE = 0.9741 / 0.7576. Weights were updated.
Avg Val Loss/MAE = 2.3350 / 1.1630
Current learning rate: 0.001
Epoch:  8
Avg Train Loss/MAE = 0.7783 / 0.6675. Weights were updated.
Avg Val Loss/MAE = 2.1287 / 1.0714
Current learning rate: 0.001
Epoch:  9
Avg Train Loss/MAE = 0.7190 / 0.6528. Weights were updated.
Avg Val Loss/MAE = 1.8692 / 1.0174
Current learning rate: 0.001
Epoch:  10
Avg Train Loss/MAE = 0.6033 / 0.6094. Weights were updated.
Avg Val Loss/MAE = 2.1531 / 1.1099
Current learning rate: 0.001
Epoch:  11
Avg Train Loss/MAE = 0.5361 / 0.5591. Weights were updated.
Avg Val Loss/MAE = 1.8811 / 1.0383
Current learning rate: 0.001
Epoch:  12
Avg Train Loss/MAE = 0.5183 / 0.5426. Weights were updated.
Avg Val Loss/MAE = 2.1578 / 1.0932
Current learning rate: 0.001
Epoch:  13
Avg Train Loss/MAE = 0.6416 / 0.5959. Weights were updated.
Avg Val Loss/MAE = 1.8299 / 1.0081
Current learning rate: 0.001
Epoch:  14
Avg Train Loss/MAE = 0.4408 / 0.4911. Weights were updated.
Avg Val Loss/MAE = 2.3804 / 1.1579
Current learning rate: 0.001
Epoch:  15
Avg Train Loss/MAE = 0.5684 / 0.5656. Weights were updated.
Avg Val Loss/MAE = 1.6791 / 0.9648
Current learning rate: 0.001
Epoch:  16
Avg Train Loss/MAE = 0.4288 / 0.4895. Weights were updated.
Avg Val Loss/MAE = 1.7950 / 0.9738
Current learning rate: 0.001
Epoch:  17
Avg Train Loss/MAE = 0.3425 / 0.4347. Weights were updated.
Avg Val Loss/MAE = 1.8215 / 0.9891
Current learning rate: 0.001
Epoch:  18
Avg Train Loss/MAE = 0.4064 / 0.4727. Weights were updated.
Avg Val Loss/MAE = 1.9262 / 1.0226
Current learning rate: 0.001
Epoch:  19
Avg Train Loss/MAE = 0.4259 / 0.4795. Weights were updated.
Avg Val Loss/MAE = 1.9291 / 1.0248
Current learning rate: 0.001
Epoch:  20
Avg Train Loss/MAE = 0.3963 / 0.4628. Weights were updated.
Avg Val Loss/MAE = 1.7559 / 0.9764
Current learning rate: 0.001
Epoch:  21
Avg Train Loss/MAE = 0.2894 / 0.3990. Weights were updated.
Avg Val Loss/MAE = 1.9831 / 1.0178
Current learning rate: 0.001
Epoch:  22
Avg Train Loss/MAE = 0.2959 / 0.4007. Weights were updated.
Avg Val Loss/MAE = 1.8357 / 1.0017
Current learning rate: 0.001
Epoch:  23
Avg Train Loss/MAE = 0.5084 / 0.5055. Weights were updated.
Avg Val Loss/MAE = 1.8919 / 1.0503
Current learning rate: 0.001
Epoch:  24
Avg Train Loss/MAE = 0.3760 / 0.4459. Weights were updated.
Avg Val Loss/MAE = 1.7510 / 0.9782
Current learning rate: 0.0001
Epoch:  25
Avg Train Loss/MAE = 0.1979 / 0.3321. Weights were updated.
Avg Val Loss/MAE = 1.8649 / 1.0106
Current learning rate: 0.0001
Epoch:  26
Avg Train Loss/MAE = 0.1443 / 0.2896. Weights were updated.
Avg Val Loss/MAE = 1.8122 / 0.9942
Current learning rate: 0.0001
Epoch:  27
Avg Train Loss/MAE = 0.1334 / 0.2761. Weights were updated.
Avg Val Loss/MAE = 1.7800 / 0.9861
Current learning rate: 0.0001
Epoch:  28
Avg Train Loss/MAE = 0.1386 / 0.2780. Weights were updated.
Avg Val Loss/MAE = 1.7916 / 0.9890
Current learning rate: 0.0001
Epoch:  29
Avg Train Loss/MAE = 0.1300 / 0.2671. Weights were updated.
Avg Val Loss/MAE = 1.7641 / 0.9785
Current learning rate: 0.0001
Epoch:  30
Avg Train Loss/MAE = 0.1192 / 0.2574. Weights were updated.
Avg Val Loss/MAE = 1.7578 / 0.9774
Current learning rate: 0.0001
Epoch:  31
Avg Train Loss/MAE = 0.1166 / 0.2555. Weights were updated.
Avg Val Loss/MAE = 1.7400 / 0.9700
Current learning rate: 0.0001
Epoch:  32
Avg Train Loss/MAE = 0.1190 / 0.2545. Weights were updated.
Avg Val Loss/MAE = 1.6991 / 0.9588
Current learning rate: 0.0001
Epoch:  33
Avg Train Loss/MAE = 0.1078 / 0.2471. Weights were updated.
Avg Val Loss/MAE = 1.7390 / 0.9697
Current learning rate: 0.0001
Epoch:  34
Avg Train Loss/MAE = 0.1039 / 0.2430. Weights were updated.
Avg Val Loss/MAE = 1.7355 / 0.9684
Current learning rate: 0.0001
Loss plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_plus_final_run/fold_2/loss_plot.png
MAE plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_plus_final_run/fold_2/mae_plot.png
Fold: 3
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Loaded 1681 image pairs.
Loaded 1681 rows of metadata.
Loaded 1681 targets.
Warning: No matching T1w image found for sub-OAS30042 in session(s). Skipping.
Loaded 358 image pairs.
Loaded 358 rows of metadata.
Loaded 358 targets.
Epoch:  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Avg Train Loss/MAE = 4.1599 / 1.5197. Weights were updated.
Avg Val Loss/MAE = 2.5476 / 1.2494
Current learning rate: 0.001
Epoch:  1
Avg Train Loss/MAE = 2.1571 / 1.1357. Weights were updated.
Avg Val Loss/MAE = 2.5869 / 1.1858
Current learning rate: 0.001
Epoch:  2
Avg Train Loss/MAE = 1.5753 / 0.9774. Weights were updated.
Avg Val Loss/MAE = 3.2895 / 1.2280
Current learning rate: 0.001
Epoch:  3
Avg Train Loss/MAE = 1.3815 / 0.9131. Weights were updated.
Avg Val Loss/MAE = 4.4455 / 1.3487
Current learning rate: 0.001
Epoch:  4
Avg Train Loss/MAE = 1.3220 / 0.8944. Weights were updated.
Avg Val Loss/MAE = 3.7191 / 1.4475
Current learning rate: 0.001
Epoch:  5
Avg Train Loss/MAE = 1.2103 / 0.8550. Weights were updated.
Avg Val Loss/MAE = 3.9142 / 1.4336
Current learning rate: 0.001
Epoch:  6
Avg Train Loss/MAE = 1.2282 / 0.8598. Weights were updated.
Avg Val Loss/MAE = 3.7824 / 1.2732
Current learning rate: 0.001
Epoch:  7
Avg Train Loss/MAE = 0.9666 / 0.7536. Weights were updated.
Avg Val Loss/MAE = 3.6612 / 1.2590
Current learning rate: 0.001
Epoch:  8
Avg Train Loss/MAE = 0.7691 / 0.6738. Weights were updated.
Avg Val Loss/MAE = 3.2371 / 1.2096
Current learning rate: 0.001
Epoch:  9
Avg Train Loss/MAE = 0.6534 / 0.6155. Weights were updated.
Avg Val Loss/MAE = 4.2695 / 1.3177
Current learning rate: 0.001
Epoch:  10
Avg Train Loss/MAE = 0.5991 / 0.5970. Weights were updated.
Avg Val Loss/MAE = 3.3609 / 1.2312
Current learning rate: 0.001
Epoch:  11
Avg Train Loss/MAE = 0.5383 / 0.5574. Weights were updated.
Avg Val Loss/MAE = 4.2409 / 1.2913
Current learning rate: 0.001
Epoch:  12
Avg Train Loss/MAE = 0.4575 / 0.5122. Weights were updated.
Avg Val Loss/MAE = 3.4881 / 1.2556
Current learning rate: 0.001
Epoch:  13
Avg Train Loss/MAE = 0.4633 / 0.5168. Weights were updated.
Avg Val Loss/MAE = 3.6482 / 1.2265
Current learning rate: 0.001
Epoch:  14
Avg Train Loss/MAE = 0.5881 / 0.5687. Weights were updated.
Avg Val Loss/MAE = 2.9645 / 1.1709
Current learning rate: 0.001
Epoch:  15
Avg Train Loss/MAE = 0.3651 / 0.4637. Weights were updated.
Avg Val Loss/MAE = 2.8318 / 1.1485
Current learning rate: 0.001
Epoch:  16
Avg Train Loss/MAE = 0.3675 / 0.4490. Weights were updated.
Avg Val Loss/MAE = 3.1897 / 1.1589
Current learning rate: 0.001
Epoch:  17
Avg Train Loss/MAE = 0.3523 / 0.4470. Weights were updated.
Avg Val Loss/MAE = 3.6670 / 1.1872
Current learning rate: 0.001
Epoch:  18
Avg Train Loss/MAE = 0.4473 / 0.4981. Weights were updated.
Avg Val Loss/MAE = 3.1040 / 1.1492
Current learning rate: 0.001
Epoch:  19
Avg Train Loss/MAE = 0.3466 / 0.4416. Weights were updated.
Avg Val Loss/MAE = 3.0640 / 1.1295
Current learning rate: 0.001
Epoch:  20
Avg Train Loss/MAE = 0.3282 / 0.4292. Weights were updated.
Avg Val Loss/MAE = 4.0360 / 1.3146
Current learning rate: 0.001
Epoch:  21
Avg Train Loss/MAE = 0.3104 / 0.4150. Weights were updated.
Avg Val Loss/MAE = 3.3269 / 1.2464
Current learning rate: 0.001
Epoch:  22
Avg Train Loss/MAE = 0.2721 / 0.3902. Weights were updated.
Avg Val Loss/MAE = 3.5281 / 1.2307
Current learning rate: 0.001
Epoch:  23
Avg Train Loss/MAE = 0.3392 / 0.4234. Weights were updated.
Avg Val Loss/MAE = 3.9234 / 1.2278
Current learning rate: 0.001
Epoch:  24
Avg Train Loss/MAE = 0.3300 / 0.4294. Weights were updated.
Avg Val Loss/MAE = 3.4059 / 1.1953
Current learning rate: 0.0001
Epoch:  25
Avg Train Loss/MAE = 0.2193 / 0.3404. Weights were updated.
Avg Val Loss/MAE = 3.3834 / 1.1783
Current learning rate: 0.0001
Epoch:  26
Avg Train Loss/MAE = 0.1668 / 0.3021. Weights were updated.
Avg Val Loss/MAE = 3.5057 / 1.1826
Current learning rate: 0.0001
Epoch:  27
Avg Train Loss/MAE = 0.1530 / 0.2849. Weights were updated.
Avg Val Loss/MAE = 3.5404 / 1.1824
Current learning rate: 0.0001
Epoch:  28
Avg Train Loss/MAE = 0.1262 / 0.2686. Weights were updated.
Avg Val Loss/MAE = 3.4170 / 1.1637
Current learning rate: 0.0001
Epoch:  29
Avg Train Loss/MAE = 0.1217 / 0.2616. Weights were updated.
Avg Val Loss/MAE = 3.5481 / 1.1859
Current learning rate: 0.0001
Epoch:  30
Avg Train Loss/MAE = 0.1178 / 0.2521. Weights were updated.
Avg Val Loss/MAE = 3.6022 / 1.1807
Current learning rate: 0.0001
Epoch:  31
Avg Train Loss/MAE = 0.1171 / 0.2558. Weights were updated.
Avg Val Loss/MAE = 3.5970 / 1.1807
Current learning rate: 0.0001
Epoch:  32
Avg Train Loss/MAE = 0.1093 / 0.2428. Weights were updated.
Avg Val Loss/MAE = 3.6505 / 1.1805
Current learning rate: 0.0001
Epoch:  33
Avg Train Loss/MAE = 0.1133 / 0.2428. Weights were updated.
Avg Val Loss/MAE = 3.6316 / 1.1829
Current learning rate: 0.0001
Epoch:  34
Avg Train Loss/MAE = 0.1107 / 0.2476. Weights were updated.
Avg Val Loss/MAE = 3.6668 / 1.1883
Current learning rate: 0.0001
Loss plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_plus_final_run/fold_3/loss_plot.png
MAE plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_plus_final_run/fold_3/mae_plot.png
Fold: 4
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Warning: No matching T1w image found for sub-OAS30042 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Loaded 1632 image pairs.
Loaded 1632 rows of metadata.
Loaded 1632 targets.
Loaded 407 image pairs.
Loaded 407 rows of metadata.
Loaded 407 targets.
Epoch:  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Avg Train Loss/MAE = 3.8229 / 1.4684. Weights were updated.
Avg Val Loss/MAE = 3.3568 / 1.4268
Current learning rate: 0.001
Epoch:  1
Avg Train Loss/MAE = 2.3277 / 1.1962. Weights were updated.
Avg Val Loss/MAE = 2.3304 / 1.1619
Current learning rate: 0.001
Epoch:  2
Avg Train Loss/MAE = 1.8477 / 1.0487. Weights were updated.
Avg Val Loss/MAE = 2.0225 / 1.1153
Current learning rate: 0.001
Epoch:  3
Avg Train Loss/MAE = 1.4691 / 0.9399. Weights were updated.
Avg Val Loss/MAE = 2.1406 / 1.1477
Current learning rate: 0.001
Epoch:  4
Avg Train Loss/MAE = 1.1657 / 0.8495. Weights were updated.
Avg Val Loss/MAE = 1.9857 / 1.0702
Current learning rate: 0.001
Epoch:  5
Avg Train Loss/MAE = 1.2899 / 0.8658. Weights were updated.
Avg Val Loss/MAE = 2.1364 / 1.1320
Current learning rate: 0.001
Epoch:  6
Avg Train Loss/MAE = 0.9700 / 0.7499. Weights were updated.
Avg Val Loss/MAE = 2.0584 / 1.1279
Current learning rate: 0.001
Epoch:  7
Avg Train Loss/MAE = 1.0276 / 0.7843. Weights were updated.
Avg Val Loss/MAE = 2.6187 / 1.2880
Current learning rate: 0.001
Epoch:  8
Avg Train Loss/MAE = 0.7438 / 0.6628. Weights were updated.
Avg Val Loss/MAE = 2.3952 / 1.1563
Current learning rate: 0.001
Epoch:  9
Avg Train Loss/MAE = 0.5305 / 0.5573. Weights were updated.
Avg Val Loss/MAE = 1.9529 / 1.0485
Current learning rate: 0.001
Epoch:  10
Avg Train Loss/MAE = 0.5248 / 0.5612. Weights were updated.
Avg Val Loss/MAE = 2.0723 / 1.1153
Current learning rate: 0.001
Epoch:  11
Avg Train Loss/MAE = 0.5359 / 0.5663. Weights were updated.
Avg Val Loss/MAE = 1.7105 / 1.0060
Current learning rate: 0.001
Epoch:  12
Avg Train Loss/MAE = 0.5116 / 0.5468. Weights were updated.
Avg Val Loss/MAE = 2.0635 / 1.1166
Current learning rate: 0.001
Epoch:  13
Avg Train Loss/MAE = 0.4158 / 0.4854. Weights were updated.
Avg Val Loss/MAE = 1.8419 / 1.0470
Current learning rate: 0.001
Epoch:  14
Avg Train Loss/MAE = 0.4281 / 0.4924. Weights were updated.
Avg Val Loss/MAE = 1.7545 / 1.0124
Current learning rate: 0.001
Epoch:  15
Avg Train Loss/MAE = 0.4362 / 0.4960. Weights were updated.
Avg Val Loss/MAE = 1.5741 / 0.9639
Current learning rate: 0.001
Epoch:  16
Avg Train Loss/MAE = 0.3584 / 0.4566. Weights were updated.
Avg Val Loss/MAE = 1.7240 / 0.9952
Current learning rate: 0.001
Epoch:  17
Avg Train Loss/MAE = 0.3213 / 0.4229. Weights were updated.
Avg Val Loss/MAE = 1.8322 / 1.0224
Current learning rate: 0.001
Epoch:  18
Avg Train Loss/MAE = 0.3469 / 0.4293. Weights were updated.
Avg Val Loss/MAE = 1.9365 / 1.0723
Current learning rate: 0.001
Epoch:  19
Avg Train Loss/MAE = 0.4059 / 0.4535. Weights were updated.
Avg Val Loss/MAE = 1.8561 / 1.0233
Current learning rate: 0.001
Epoch:  20
Avg Train Loss/MAE = 0.3863 / 0.4558. Weights were updated.
Avg Val Loss/MAE = 1.7784 / 1.0274
Current learning rate: 0.001
Epoch:  21
Avg Train Loss/MAE = 0.3187 / 0.4158. Weights were updated.
Avg Val Loss/MAE = 1.7910 / 1.0329
Current learning rate: 0.001
Epoch:  22
Avg Train Loss/MAE = 0.2355 / 0.3579. Weights were updated.
Avg Val Loss/MAE = 1.7713 / 1.0275
Current learning rate: 0.001
Epoch:  23
Avg Train Loss/MAE = 0.3040 / 0.4107. Weights were updated.
Avg Val Loss/MAE = 2.0369 / 1.0724
Current learning rate: 0.001
Epoch:  24
Avg Train Loss/MAE = 0.2943 / 0.3994. Weights were updated.
Avg Val Loss/MAE = 2.0265 / 1.0614
Current learning rate: 0.0001
Epoch:  25
Avg Train Loss/MAE = 0.2072 / 0.3371. Weights were updated.
Avg Val Loss/MAE = 1.8490 / 1.0284
Current learning rate: 0.0001
Epoch:  26
Avg Train Loss/MAE = 0.1408 / 0.2797. Weights were updated.
Avg Val Loss/MAE = 1.7765 / 1.0101
Current learning rate: 0.0001
Epoch:  27
Avg Train Loss/MAE = 0.1363 / 0.2773. Weights were updated.
Avg Val Loss/MAE = 1.6922 / 0.9893
Current learning rate: 0.0001
Epoch:  28
Avg Train Loss/MAE = 0.1344 / 0.2707. Weights were updated.
Avg Val Loss/MAE = 1.7098 / 0.9879
Current learning rate: 0.0001
Epoch:  29
Avg Train Loss/MAE = 0.1035 / 0.2453. Weights were updated.
Avg Val Loss/MAE = 1.7616 / 1.0037
Current learning rate: 0.0001
Epoch:  30
Avg Train Loss/MAE = 0.1087 / 0.2490. Weights were updated.
Avg Val Loss/MAE = 1.7716 / 1.0039
Current learning rate: 0.0001
Epoch:  31
Avg Train Loss/MAE = 0.1038 / 0.2402. Weights were updated.
Avg Val Loss/MAE = 1.8018 / 1.0137
Current learning rate: 0.0001
Epoch:  32
Avg Train Loss/MAE = 0.1075 / 0.2455. Weights were updated.
Avg Val Loss/MAE = 1.7786 / 1.0097
Current learning rate: 0.0001
Epoch:  33
Avg Train Loss/MAE = 0.0948 / 0.2302. Weights were updated.
Avg Val Loss/MAE = 1.7327 / 0.9932
Current learning rate: 0.0001
Epoch:  34
Avg Train Loss/MAE = 0.0948 / 0.2302. Weights were updated.
Avg Val Loss/MAE = 1.7128 / 0.9906
Current learning rate: 0.0001
Loss plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_plus_final_run/fold_4/loss_plot.png
MAE plot saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/LILAC_plus_final_run/fold_4/mae_plot.png
