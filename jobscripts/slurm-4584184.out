This job can be monitored from: https://job.c3se.chalmers.se/alvis/4584184
We are in main.
Warning: Folder for participant sub-OAS30937 does not exist and will be deleted.
Warning: Folder for participant sub-OAS31357 does not exist and will be deleted.
We are in fold: 0
We are in train.
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Warning: No matching T1w image found for sub-OAS30042 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Loaded 1818 image pairs.
Loaded 1818 rows of metadata.
Loaded 1818 targets.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Loaded 524 image pairs.
Loaded 524 rows of metadata.
Loaded 524 targets.
We are in epoch (training):  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Epoch 0: Avg Train Loss = 7.5009
Epoch 0: Avg Train MAE = 2.0314
We are in epoch (val):  0
Epoch 0: Avg Val Loss = 5.5823
Epoch 0: Avg Val MAE = 1.7279
We are in epoch (training):  1
Epoch 1: Avg Train Loss = 6.0527
Epoch 1: Avg Train MAE = 1.7669
We are in epoch (val):  1
Epoch 1: Avg Val Loss = 5.8223
Epoch 1: Avg Val MAE = 1.7069
We are in epoch (training):  2
Epoch 2: Avg Train Loss = 4.5645
Epoch 2: Avg Train MAE = 1.5934
We are in epoch (val):  2
Epoch 2: Avg Val Loss = 4.6718
Epoch 2: Avg Val MAE = 1.5724
We are in epoch (training):  3
Epoch 3: Avg Train Loss = 3.7052
Epoch 3: Avg Train MAE = 1.4427
We are in epoch (val):  3
Epoch 3: Avg Val Loss = 4.9891
Epoch 3: Avg Val MAE = 1.6066
We are in epoch (training):  4
Epoch 4: Avg Train Loss = 3.5316
Epoch 4: Avg Train MAE = 1.4192
We are in epoch (val):  4
Epoch 4: Avg Val Loss = 4.6210
Epoch 4: Avg Val MAE = 1.5810
We are in epoch (training):  5
Epoch 5: Avg Train Loss = 3.0819
Epoch 5: Avg Train MAE = 1.3159
We are in epoch (val):  5
Epoch 5: Avg Val Loss = 3.2545
Epoch 5: Avg Val MAE = 1.3045
We are in epoch (training):  6
Epoch 6: Avg Train Loss = 3.0208
Epoch 6: Avg Train MAE = 1.2920
We are in epoch (val):  6
Epoch 6: Avg Val Loss = 3.1899
Epoch 6: Avg Val MAE = 1.2651
We are in epoch (training):  7
Epoch 7: Avg Train Loss = 2.6701
Epoch 7: Avg Train MAE = 1.2326
We are in epoch (val):  7
Epoch 7: Avg Val Loss = 3.3315
Epoch 7: Avg Val MAE = 1.2970
We are in epoch (training):  8
Epoch 8: Avg Train Loss = 2.4312
Epoch 8: Avg Train MAE = 1.1709
We are in epoch (val):  8
Epoch 8: Avg Val Loss = 3.1876
Epoch 8: Avg Val MAE = 1.2747
We are in epoch (training):  9
Epoch 9: Avg Train Loss = 2.1548
Epoch 9: Avg Train MAE = 1.1072
We are in epoch (val):  9
Epoch 9: Avg Val Loss = 5.2067
Epoch 9: Avg Val MAE = 1.5180
We are in epoch (training):  10
Epoch 10: Avg Train Loss = 2.5401
Epoch 10: Avg Train MAE = 1.1638
We are in epoch (val):  10
Epoch 10: Avg Val Loss = 3.4009
Epoch 10: Avg Val MAE = 1.3249
We are in epoch (training):  11
Epoch 11: Avg Train Loss = 2.2541
Epoch 11: Avg Train MAE = 1.1184
We are in epoch (val):  11
Epoch 11: Avg Val Loss = 3.1042
Epoch 11: Avg Val MAE = 1.2636
We are in epoch (training):  12
Epoch 12: Avg Train Loss = 2.1265
Epoch 12: Avg Train MAE = 1.0526
We are in epoch (val):  12
Epoch 12: Avg Val Loss = 3.3183
Epoch 12: Avg Val MAE = 1.2733
We are in epoch (training):  13
Epoch 13: Avg Train Loss = 2.0188
Epoch 13: Avg Train MAE = 1.0454
We are in epoch (val):  13
Epoch 13: Avg Val Loss = 2.9136
Epoch 13: Avg Val MAE = 1.2068
We are in epoch (training):  14
Epoch 14: Avg Train Loss = 1.8278
Epoch 14: Avg Train MAE = 0.9905
We are in epoch (val):  14
Epoch 14: Avg Val Loss = 4.3428
Epoch 14: Avg Val MAE = 1.4481
We are in epoch (training):  15
Epoch 15: Avg Train Loss = 1.8186
Epoch 15: Avg Train MAE = 0.9872
We are in epoch (val):  15
Epoch 15: Avg Val Loss = 4.9031
Epoch 15: Avg Val MAE = 1.4610
We are in epoch (training):  16
Epoch 16: Avg Train Loss = 1.5196
Epoch 16: Avg Train MAE = 0.9160
We are in epoch (val):  16
Epoch 16: Avg Val Loss = 3.0877
Epoch 16: Avg Val MAE = 1.2573
We are in epoch (training):  17
Epoch 17: Avg Train Loss = 1.6532
Epoch 17: Avg Train MAE = 0.9440
We are in epoch (val):  17
Epoch 17: Avg Val Loss = 3.2027
Epoch 17: Avg Val MAE = 1.3166
We are in epoch (training):  18
Epoch 18: Avg Train Loss = 1.3763
Epoch 18: Avg Train MAE = 0.8435
We are in epoch (val):  18
Epoch 18: Avg Val Loss = 3.4219
Epoch 18: Avg Val MAE = 1.2671
We are in epoch (training):  19
Epoch 19: Avg Train Loss = 1.6132
Epoch 19: Avg Train MAE = 0.9052
We are in epoch (val):  19
Epoch 19: Avg Val Loss = 4.0556
Epoch 19: Avg Val MAE = 1.3504
We are in epoch (training):  20
Epoch 20: Avg Train Loss = 1.3383
Epoch 20: Avg Train MAE = 0.8423
We are in epoch (val):  20
Epoch 20: Avg Val Loss = 2.7791
Epoch 20: Avg Val MAE = 1.1740
We are in epoch (training):  21
Epoch 21: Avg Train Loss = 1.2683
Epoch 21: Avg Train MAE = 0.8166
We are in epoch (val):  21
Epoch 21: Avg Val Loss = 2.8447
Epoch 21: Avg Val MAE = 1.2295
We are in epoch (training):  22
Epoch 22: Avg Train Loss = 1.3314
Epoch 22: Avg Train MAE = 0.8385
We are in epoch (val):  22
Epoch 22: Avg Val Loss = 3.1913
Epoch 22: Avg Val MAE = 1.2688
We are in epoch (training):  23
Epoch 23: Avg Train Loss = 1.3052
Epoch 23: Avg Train MAE = 0.8267
We are in epoch (val):  23
Epoch 23: Avg Val Loss = 2.6813
Epoch 23: Avg Val MAE = 1.1871
We are in epoch (training):  24
Epoch 24: Avg Train Loss = 1.6757
Epoch 24: Avg Train MAE = 0.9069
We are in epoch (val):  24
Epoch 24: Avg Val Loss = 3.7389
Epoch 24: Avg Val MAE = 1.3168
We are in epoch (training):  25
Epoch 25: Avg Train Loss = 1.1914
Epoch 25: Avg Train MAE = 0.7636
We are in epoch (val):  25
Epoch 25: Avg Val Loss = 2.7599
Epoch 25: Avg Val MAE = 1.1932
We are in epoch (training):  26
Epoch 26: Avg Train Loss = 0.9916
Epoch 26: Avg Train MAE = 0.7098
We are in epoch (val):  26
Epoch 26: Avg Val Loss = 3.0129
Epoch 26: Avg Val MAE = 1.2535
We are in epoch (training):  27
Epoch 27: Avg Train Loss = 0.9464
Epoch 27: Avg Train MAE = 0.6984
We are in epoch (val):  27
Epoch 27: Avg Val Loss = 3.5875
Epoch 27: Avg Val MAE = 1.3342
We are in epoch (training):  28
Epoch 28: Avg Train Loss = 1.2360
Epoch 28: Avg Train MAE = 0.7817
We are in epoch (val):  28
Epoch 28: Avg Val Loss = 3.0790
Epoch 28: Avg Val MAE = 1.2192
We are in epoch (training):  29
Epoch 29: Avg Train Loss = 1.0675
Epoch 29: Avg Train MAE = 0.7264
We are in epoch (val):  29
Epoch 29: Avg Val Loss = 3.0724
Epoch 29: Avg Val MAE = 1.2533
Training complete. Will now calculate predicted values on train and test set.
Loss plot (Train/Val) saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/proper_CV_w_MLP_wo_age/fold_0/loss_plot.png
MAE plot (Train/Val) saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/proper_CV_w_MLP_wo_age/fold_0/mae_plot.png
We are in fold: 1
We are in train.
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Warning: No matching T1w image found for sub-OAS30042 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Loaded 1804 image pairs.
Loaded 1804 rows of metadata.
Loaded 1804 targets.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Loaded 538 image pairs.
Loaded 538 rows of metadata.
Loaded 538 targets.
We are in epoch (training):  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Epoch 0: Avg Train Loss = 9.2144
Epoch 0: Avg Train MAE = 2.1981
We are in epoch (val):  0
Epoch 0: Avg Val Loss = 4.0996
Epoch 0: Avg Val MAE = 1.5332
We are in epoch (training):  1
Epoch 1: Avg Train Loss = 5.3897
Epoch 1: Avg Train MAE = 1.7115
We are in epoch (val):  1
Epoch 1: Avg Val Loss = 3.7328
Epoch 1: Avg Val MAE = 1.4652
We are in epoch (training):  2
Epoch 2: Avg Train Loss = 4.3227
Epoch 2: Avg Train MAE = 1.5433
We are in epoch (val):  2
Epoch 2: Avg Val Loss = 3.1456
Epoch 2: Avg Val MAE = 1.3817
We are in epoch (training):  3
Epoch 3: Avg Train Loss = 3.8117
Epoch 3: Avg Train MAE = 1.4659
We are in epoch (val):  3
Epoch 3: Avg Val Loss = 4.8997
Epoch 3: Avg Val MAE = 1.5662
We are in epoch (training):  4
Epoch 4: Avg Train Loss = 3.7840
Epoch 4: Avg Train MAE = 1.4328
We are in epoch (val):  4
Epoch 4: Avg Val Loss = 3.3006
Epoch 4: Avg Val MAE = 1.3657
We are in epoch (training):  5
Epoch 5: Avg Train Loss = 3.6146
Epoch 5: Avg Train MAE = 1.4105
We are in epoch (val):  5
Epoch 5: Avg Val Loss = 3.2618
Epoch 5: Avg Val MAE = 1.3697
We are in epoch (training):  6
Epoch 6: Avg Train Loss = 3.1121
Epoch 6: Avg Train MAE = 1.2942
We are in epoch (val):  6
Epoch 6: Avg Val Loss = 4.1292
Epoch 6: Avg Val MAE = 1.5860
We are in epoch (training):  7
Epoch 7: Avg Train Loss = 3.1549
Epoch 7: Avg Train MAE = 1.3089
We are in epoch (val):  7
Epoch 7: Avg Val Loss = 3.9433
Epoch 7: Avg Val MAE = 1.4916
We are in epoch (training):  8
Epoch 8: Avg Train Loss = 2.7537
Epoch 8: Avg Train MAE = 1.2177
We are in epoch (val):  8
Epoch 8: Avg Val Loss = 3.2575
Epoch 8: Avg Val MAE = 1.3995
We are in epoch (training):  9
Epoch 9: Avg Train Loss = 3.1741
Epoch 9: Avg Train MAE = 1.2923
We are in epoch (val):  9
Epoch 9: Avg Val Loss = 3.2669
Epoch 9: Avg Val MAE = 1.3631
We are in epoch (training):  10
Epoch 10: Avg Train Loss = 2.5576
Epoch 10: Avg Train MAE = 1.1839
We are in epoch (val):  10
Epoch 10: Avg Val Loss = 2.6414
Epoch 10: Avg Val MAE = 1.2430
We are in epoch (training):  11
Epoch 11: Avg Train Loss = 2.6273
Epoch 11: Avg Train MAE = 1.2140
We are in epoch (val):  11
Epoch 11: Avg Val Loss = 2.5299
Epoch 11: Avg Val MAE = 1.2256
We are in epoch (training):  12
Epoch 12: Avg Train Loss = 2.1421
Epoch 12: Avg Train MAE = 1.0828
We are in epoch (val):  12
Epoch 12: Avg Val Loss = 3.0930
Epoch 12: Avg Val MAE = 1.3005
We are in epoch (training):  13
Epoch 13: Avg Train Loss = 2.4384
Epoch 13: Avg Train MAE = 1.1702
We are in epoch (val):  13
Epoch 13: Avg Val Loss = 2.4230
Epoch 13: Avg Val MAE = 1.1859
We are in epoch (training):  14
Epoch 14: Avg Train Loss = 2.4180
Epoch 14: Avg Train MAE = 1.1403
We are in epoch (val):  14
Epoch 14: Avg Val Loss = 2.8841
Epoch 14: Avg Val MAE = 1.2968
We are in epoch (training):  15
Epoch 15: Avg Train Loss = 2.1086
Epoch 15: Avg Train MAE = 1.0762
We are in epoch (val):  15
Epoch 15: Avg Val Loss = 2.6384
Epoch 15: Avg Val MAE = 1.2682
We are in epoch (training):  16
Epoch 16: Avg Train Loss = 1.7984
Epoch 16: Avg Train MAE = 1.0020
We are in epoch (val):  16
Epoch 16: Avg Val Loss = 3.5399
Epoch 16: Avg Val MAE = 1.4037
We are in epoch (training):  17
Epoch 17: Avg Train Loss = 1.8481
Epoch 17: Avg Train MAE = 1.0087
We are in epoch (val):  17
Epoch 17: Avg Val Loss = 2.6093
Epoch 17: Avg Val MAE = 1.2193
We are in epoch (training):  18
Epoch 18: Avg Train Loss = 1.8689
Epoch 18: Avg Train MAE = 0.9867
We are in epoch (val):  18
Epoch 18: Avg Val Loss = 2.5777
Epoch 18: Avg Val MAE = 1.2314
We are in epoch (training):  19
Epoch 19: Avg Train Loss = 1.9440
Epoch 19: Avg Train MAE = 0.9928
We are in epoch (val):  19
Epoch 19: Avg Val Loss = 4.4430
Epoch 19: Avg Val MAE = 1.4996
We are in epoch (training):  20
Epoch 20: Avg Train Loss = 1.8276
Epoch 20: Avg Train MAE = 0.9863
We are in epoch (val):  20
Epoch 20: Avg Val Loss = 3.0628
Epoch 20: Avg Val MAE = 1.2948
We are in epoch (training):  21
Epoch 21: Avg Train Loss = 1.5721
Epoch 21: Avg Train MAE = 0.9256
We are in epoch (val):  21
Epoch 21: Avg Val Loss = 2.4735
Epoch 21: Avg Val MAE = 1.2088
We are in epoch (training):  22
Epoch 22: Avg Train Loss = 1.5753
Epoch 22: Avg Train MAE = 0.9028
We are in epoch (val):  22
Epoch 22: Avg Val Loss = 2.3355
Epoch 22: Avg Val MAE = 1.1880
We are in epoch (training):  23
Epoch 23: Avg Train Loss = 1.6376
Epoch 23: Avg Train MAE = 0.9208
We are in epoch (val):  23
Epoch 23: Avg Val Loss = 2.5358
Epoch 23: Avg Val MAE = 1.2186
We are in epoch (training):  24
Epoch 24: Avg Train Loss = 1.6848
Epoch 24: Avg Train MAE = 0.9430
We are in epoch (val):  24
Epoch 24: Avg Val Loss = 2.5327
Epoch 24: Avg Val MAE = 1.2245
We are in epoch (training):  25
Epoch 25: Avg Train Loss = 1.4290
Epoch 25: Avg Train MAE = 0.8755
We are in epoch (val):  25
Epoch 25: Avg Val Loss = 2.8181
Epoch 25: Avg Val MAE = 1.2924
We are in epoch (training):  26
Epoch 26: Avg Train Loss = 1.2558
Epoch 26: Avg Train MAE = 0.8186
We are in epoch (val):  26
Epoch 26: Avg Val Loss = 2.1421
Epoch 26: Avg Val MAE = 1.1112
We are in epoch (training):  27
Epoch 27: Avg Train Loss = 1.5206
Epoch 27: Avg Train MAE = 0.8984
We are in epoch (val):  27
Epoch 27: Avg Val Loss = 2.4460
Epoch 27: Avg Val MAE = 1.2133
We are in epoch (training):  28
Epoch 28: Avg Train Loss = 1.4121
Epoch 28: Avg Train MAE = 0.8481
We are in epoch (val):  28
Epoch 28: Avg Val Loss = 2.9281
Epoch 28: Avg Val MAE = 1.2459
We are in epoch (training):  29
Epoch 29: Avg Train Loss = 1.3514
Epoch 29: Avg Train MAE = 0.8231
We are in epoch (val):  29
Epoch 29: Avg Val Loss = 2.2110
Epoch 29: Avg Val MAE = 1.1342
Training complete. Will now calculate predicted values on train and test set.
Loss plot (Train/Val) saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/proper_CV_w_MLP_wo_age/fold_1/loss_plot.png
MAE plot (Train/Val) saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/proper_CV_w_MLP_wo_age/fold_1/mae_plot.png
We are in fold: 2
We are in train.
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Warning: No matching T1w image found for sub-OAS30042 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Loaded 1878 image pairs.
Loaded 1878 rows of metadata.
Loaded 1878 targets.
Loaded 464 image pairs.
Loaded 464 rows of metadata.
Loaded 464 targets.
We are in epoch (training):  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Epoch 0: Avg Train Loss = 8.8208
Epoch 0: Avg Train MAE = 2.1814
We are in epoch (val):  0
Epoch 0: Avg Val Loss = 4.8120
Epoch 0: Avg Val MAE = 1.6939
We are in epoch (training):  1
Epoch 1: Avg Train Loss = 5.5805
Epoch 1: Avg Train MAE = 1.7737
We are in epoch (val):  1
Epoch 1: Avg Val Loss = 5.4847
Epoch 1: Avg Val MAE = 1.7253
We are in epoch (training):  2
Epoch 2: Avg Train Loss = 4.3909
Epoch 2: Avg Train MAE = 1.5822
We are in epoch (val):  2
Epoch 2: Avg Val Loss = 4.6906
Epoch 2: Avg Val MAE = 1.6463
We are in epoch (training):  3
Epoch 3: Avg Train Loss = 3.8216
Epoch 3: Avg Train MAE = 1.4610
We are in epoch (val):  3
Epoch 3: Avg Val Loss = 5.3178
Epoch 3: Avg Val MAE = 1.7285
We are in epoch (training):  4
Epoch 4: Avg Train Loss = 3.5701
Epoch 4: Avg Train MAE = 1.4215
We are in epoch (val):  4
Epoch 4: Avg Val Loss = 4.5864
Epoch 4: Avg Val MAE = 1.5758
We are in epoch (training):  5
Epoch 5: Avg Train Loss = 3.4378
Epoch 5: Avg Train MAE = 1.4003
We are in epoch (val):  5
Epoch 5: Avg Val Loss = 4.0690
Epoch 5: Avg Val MAE = 1.5443
We are in epoch (training):  6
Epoch 6: Avg Train Loss = 3.4703
Epoch 6: Avg Train MAE = 1.4083
We are in epoch (val):  6
Epoch 6: Avg Val Loss = 3.6338
Epoch 6: Avg Val MAE = 1.4050
We are in epoch (training):  7
Epoch 7: Avg Train Loss = 2.9325
Epoch 7: Avg Train MAE = 1.2701
We are in epoch (val):  7
Epoch 7: Avg Val Loss = 3.8778
Epoch 7: Avg Val MAE = 1.4345
We are in epoch (training):  8
Epoch 8: Avg Train Loss = 3.1031
Epoch 8: Avg Train MAE = 1.3254
We are in epoch (val):  8
Epoch 8: Avg Val Loss = 3.9737
Epoch 8: Avg Val MAE = 1.4735
We are in epoch (training):  9
Epoch 9: Avg Train Loss = 2.6244
Epoch 9: Avg Train MAE = 1.2069
We are in epoch (val):  9
Epoch 9: Avg Val Loss = 3.4203
Epoch 9: Avg Val MAE = 1.3828
We are in epoch (training):  10
Epoch 10: Avg Train Loss = 2.5022
Epoch 10: Avg Train MAE = 1.1954
We are in epoch (val):  10
Epoch 10: Avg Val Loss = 3.8195
Epoch 10: Avg Val MAE = 1.4656
We are in epoch (training):  11
Epoch 11: Avg Train Loss = 2.3077
Epoch 11: Avg Train MAE = 1.1421
We are in epoch (val):  11
Epoch 11: Avg Val Loss = 3.8743
Epoch 11: Avg Val MAE = 1.4511
We are in epoch (training):  12
Epoch 12: Avg Train Loss = 2.2430
Epoch 12: Avg Train MAE = 1.1210
We are in epoch (val):  12
Epoch 12: Avg Val Loss = 4.6854
Epoch 12: Avg Val MAE = 1.5672
We are in epoch (training):  13
Epoch 13: Avg Train Loss = 2.3127
Epoch 13: Avg Train MAE = 1.1340
We are in epoch (val):  13
Epoch 13: Avg Val Loss = 4.1710
Epoch 13: Avg Val MAE = 1.4841
We are in epoch (training):  14
Epoch 14: Avg Train Loss = 2.0190
Epoch 14: Avg Train MAE = 1.0697
We are in epoch (val):  14
Epoch 14: Avg Val Loss = 4.7789
Epoch 14: Avg Val MAE = 1.5046
We are in epoch (training):  15
Epoch 15: Avg Train Loss = 2.0158
Epoch 15: Avg Train MAE = 1.0469
We are in epoch (val):  15
Epoch 15: Avg Val Loss = 3.4733
Epoch 15: Avg Val MAE = 1.3862
We are in epoch (training):  16
Epoch 16: Avg Train Loss = 1.9650
Epoch 16: Avg Train MAE = 1.0457
We are in epoch (val):  16
Epoch 16: Avg Val Loss = 3.5462
Epoch 16: Avg Val MAE = 1.4099
We are in epoch (training):  17
Epoch 17: Avg Train Loss = 1.7914
Epoch 17: Avg Train MAE = 0.9891
We are in epoch (val):  17
Epoch 17: Avg Val Loss = 3.7162
Epoch 17: Avg Val MAE = 1.4408
We are in epoch (training):  18
Epoch 18: Avg Train Loss = 1.8364
Epoch 18: Avg Train MAE = 1.0118
We are in epoch (val):  18
Epoch 18: Avg Val Loss = 3.5157
Epoch 18: Avg Val MAE = 1.4177
We are in epoch (training):  19
Epoch 19: Avg Train Loss = 1.8339
Epoch 19: Avg Train MAE = 0.9949
We are in epoch (val):  19
Epoch 19: Avg Val Loss = 3.5451
Epoch 19: Avg Val MAE = 1.4109
We are in epoch (training):  20
Epoch 20: Avg Train Loss = 1.6402
Epoch 20: Avg Train MAE = 0.9478
We are in epoch (val):  20
Epoch 20: Avg Val Loss = 3.1535
Epoch 20: Avg Val MAE = 1.3129
We are in epoch (training):  21
Epoch 21: Avg Train Loss = 1.5864
Epoch 21: Avg Train MAE = 0.9332
We are in epoch (val):  21
Epoch 21: Avg Val Loss = 3.4140
Epoch 21: Avg Val MAE = 1.3671
We are in epoch (training):  22
Epoch 22: Avg Train Loss = 1.4760
Epoch 22: Avg Train MAE = 0.9067
We are in epoch (val):  22
Epoch 22: Avg Val Loss = 3.1337
Epoch 22: Avg Val MAE = 1.3024
We are in epoch (training):  23
Epoch 23: Avg Train Loss = 1.3753
Epoch 23: Avg Train MAE = 0.8910
We are in epoch (val):  23
Epoch 23: Avg Val Loss = 3.1490
Epoch 23: Avg Val MAE = 1.3087
We are in epoch (training):  24
Epoch 24: Avg Train Loss = 1.2876
Epoch 24: Avg Train MAE = 0.8272
We are in epoch (val):  24
Epoch 24: Avg Val Loss = 3.4326
Epoch 24: Avg Val MAE = 1.3910
We are in epoch (training):  25
Epoch 25: Avg Train Loss = 1.4437
Epoch 25: Avg Train MAE = 0.8846
We are in epoch (val):  25
Epoch 25: Avg Val Loss = 3.7363
Epoch 25: Avg Val MAE = 1.4200
We are in epoch (training):  26
Epoch 26: Avg Train Loss = 1.5604
Epoch 26: Avg Train MAE = 0.9014
We are in epoch (val):  26
Epoch 26: Avg Val Loss = 3.0798
Epoch 26: Avg Val MAE = 1.3057
We are in epoch (training):  27
Epoch 27: Avg Train Loss = 1.2962
Epoch 27: Avg Train MAE = 0.8370
We are in epoch (val):  27
Epoch 27: Avg Val Loss = 3.2033
Epoch 27: Avg Val MAE = 1.3601
We are in epoch (training):  28
Epoch 28: Avg Train Loss = 1.2993
Epoch 28: Avg Train MAE = 0.8332
We are in epoch (val):  28
Epoch 28: Avg Val Loss = 3.7036
Epoch 28: Avg Val MAE = 1.4292
We are in epoch (training):  29
Epoch 29: Avg Train Loss = 1.0782
Epoch 29: Avg Train MAE = 0.7619
We are in epoch (val):  29
Epoch 29: Avg Val Loss = 3.1539
Epoch 29: Avg Val MAE = 1.3385
Training complete. Will now calculate predicted values on train and test set.
Loss plot (Train/Val) saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/proper_CV_w_MLP_wo_age/fold_2/loss_plot.png
MAE plot (Train/Val) saved to: /mimer/NOBACKUP/groups/brainage/thesis_brainage/results/proper_CV_w_MLP_wo_age/fold_2/mae_plot.png
We are in fold: 3
We are in train.
Using device: cuda
Last block has number of input channels: 64
Last block has number of output channels: 16
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30137 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30369 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30659 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30797 in session(s). Skipping.
Loaded 1904 image pairs.
Loaded 1904 rows of metadata.
Loaded 1904 targets.
Warning: No matching T1w image found for sub-OAS30042 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Warning: No matching T1w image found for sub-OAS30643 in session(s). Skipping.
Loaded 438 image pairs.
Loaded 438 rows of metadata.
Loaded 438 targets.
We are in epoch (training):  0
/mimer/NOBACKUP/groups/brainage/thesis_brainage/my_venv/lib/python3.12/site-packages/torchio/data/image.py:248: UserWarning: Using TorchIO images without a torchio.SubjectsLoader in PyTorch >= 2.3 might have unexpected consequences, e.g., the collated batches will be instances of torchio.Subject with 5D images. Replace your PyTorch DataLoader with a torchio.SubjectsLoader so that the collated batch becomes a dictionary, as expected. See https://github.com/TorchIO-project/torchio/issues/1179 for more context about this issue.
  warnings.warn(message, stacklevel=1)
Epoch 0: Avg Train Loss = 6.7714
Epoch 0: Avg Train MAE = 1.8967
We are in epoch (val):  0
Epoch 0: Avg Val Loss = 7.3514
Epoch 0: Avg Val MAE = 1.7393
We are in epoch (training):  1
Epoch 1: Avg Train Loss = 5.0185
Epoch 1: Avg Train MAE = 1.6425
We are in epoch (val):  1
Epoch 1: Avg Val Loss = 6.0667
Epoch 1: Avg Val MAE = 1.6523
We are in epoch (training):  2
Epoch 2: Avg Train Loss = 4.3638
Epoch 2: Avg Train MAE = 1.5422
We are in epoch (val):  2
Epoch 2: Avg Val Loss = 6.3302
Epoch 2: Avg Val MAE = 1.6358
We are in epoch (training):  3
Epoch 3: Avg Train Loss = 4.2182
Epoch 3: Avg Train MAE = 1.4703
We are in epoch (val):  3
Epoch 3: Avg Val Loss = 4.5833
Epoch 3: Avg Val MAE = 1.4949
We are in epoch (training):  4
Epoch 4: Avg Train Loss = 3.5081
Epoch 4: Avg Train MAE = 1.3661
We are in epoch (val):  4
Epoch 4: Avg Val Loss = 5.6556
Epoch 4: Avg Val MAE = 1.6964
We are in epoch (training):  5
Epoch 5: Avg Train Loss = 3.7888
Epoch 5: Avg Train MAE = 1.4288
We are in epoch (val):  5
Epoch 5: Avg Val Loss = 3.9982
Epoch 5: Avg Val MAE = 1.3983
We are in epoch (training):  6
Epoch 6: Avg Train Loss = 3.0749
Epoch 6: Avg Train MAE = 1.2779
We are in epoch (val):  6
Epoch 6: Avg Val Loss = 5.1035
Epoch 6: Avg Val MAE = 1.5308
We are in epoch (training):  7
Epoch 7: Avg Train Loss = 3.0976
Epoch 7: Avg Train MAE = 1.2822
We are in epoch (val):  7
Epoch 7: Avg Val Loss = 3.7540
Epoch 7: Avg Val MAE = 1.3677
We are in epoch (training):  8
Epoch 8: Avg Train Loss = 2.9477
Epoch 8: Avg Train MAE = 1.2296
We are in epoch (val):  8
Epoch 8: Avg Val Loss = 3.5470
Epoch 8: Avg Val MAE = 1.3648
We are in epoch (training):  9
Epoch 9: Avg Train Loss = 2.6176
Epoch 9: Avg Train MAE = 1.1741
We are in epoch (val):  9
Epoch 9: Avg Val Loss = 3.4824
Epoch 9: Avg Val MAE = 1.3694
We are in epoch (training):  10
Epoch 10: Avg Train Loss = 2.5026
Epoch 10: Avg Train MAE = 1.1691
We are in epoch (val):  10
Epoch 10: Avg Val Loss = 3.8607
Epoch 10: Avg Val MAE = 1.4455
We are in epoch (training):  11
